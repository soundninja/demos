<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;-moz-box-sizing:border-box;box-sizing:border-box}body{font-family:"Helvetica Neue",Helvetica,Helvetica,Arial,sans-serif}</style>
</head>
<body>
<script>require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./utils.js"),e=a("./browser.js"),f=function(){return this instanceof f?void this.init():new f};f.prototype.init=function(){this.data={}},f.prototype.add=function(a,b,c,d){c=c===!0?!0:!1;var e={func:b,one:c,ctx:d};return this.data.hasOwnProperty(a)?this.data[a].push(e):this.data[a]=[e],this},f.prototype.on=function(a,b,c){return this.add(a,b,!1,c)},f.prototype.off=function(a,b){if(!this.data.hasOwnProperty(a))return this;var c=d.reduce(this.data[a],function(a,c){return d.isNone(b)||c.func!==b?d.isNone(b)?a:(a.push(c),a):a},[]);return 0===c.length?delete this.data[a]:this.data[a]=c,this},f.prototype.one=function(a,b,c){return this.add(a,b,!0,c)},f.prototype.get=function(a,b,c,d){this.one(a+".response",c,d),this.notify(a,b)},f.prototype.notify=function(){var a=Array.prototype.slice.call(arguments,0);if(0===a.length)return this;var b=a.splice(0,1)[0];if(!this.data.hasOwnProperty(b))return this;var c,f=[],g=[];return d.each(this.data[b],function(a){g.push(a),a.one===!1&&f.push(a)}),0===f.length?delete this.data[b]:this.data[b]=f,d.each(g,function(f){try{c=d.isNone(f.ctx)?this:f.ctx,f.func.apply(c,a)}catch(g){e.console.error(b,a,g)}},this),this},b.exports=f},{"./browser.js":3,"./utils.js":23}],2:[function(a,b,c){!function(){var c=a("./utils.js"),d=a("./browser.js"),e=a("./json.js"),f=a("conf"),g={};g.batch=function(a,b){var d=[],e=[];return c.each(a,function(a){e.push(a),e.length===b&&(d.push(e),e=[])}),0!==e.length&&d.push(e),d},g.random=function(a){return Math.floor(Math.random()*a)},g.safeCreateQuery=function(a){var b=c.map(a,function(a,b){return b+"="+("urls"===b?a:encodeURIComponent(a))});return b.sort(),b.join("&")},g.Keeper=function(a,b){this.init(a,b)},g.Keeper.prototype={init:function(a,b){this.urls=a,this.count=0,this.results={},this.callback=b},each:function(a){if(this.results[a.original_url]=a,this.count++,this.count===this.urls.length){var b=c.map(this.urls,function(a){return this.results[a]},this);this.callback(b)}return this}},g.ajax=function(a,b,c){var d=new XMLHttpRequest;if("withCredentials"in d)d.open("GET",a,!0),c===!0&&(d.withCredentials=!0),d.setRequestHeader("Accept","application/json"),d.onreadystatechange=function(a){4===d.readyState&&(200===d.status?b&&b(e.parse(d.responseText)):b&&b({type:"error"}))};else{if("undefined"==typeof XDomainRequest)return b({type:"error"}),!1;d=new XDomainRequest,d.open("GET",a),d.onload=function(){b&&b(e.parse(d.responseText))},d.onerror=function(){b({type:"error"})},d.onprogress=function(){}}d.send(null)},g.API=function(a){this.init(a)},g.API.prototype.init=function(a){c.isString(a)?this.key=a:c.isNone(a)||(this.key=a.key),this.key=this.key?this.key:f.EMB_API_KEY,this.protocol="https:"===window.location.protocol?"https:":"http:"},g.API.prototype._buildUrl=function(a,b){if(c.isNone(this.key))return null;var d=this.protocol+"//api-cdn-"+g.random(5)+".embed.ly/"+a;return b=b?b:{},b.key=this.key,d+"?"+g.safeCreateQuery(b)},g.API.prototype._data=function(a,b,e,f){if(d.console.log(a,b,e,f),c.isNone(f)&&c.isFunction(e)&&(f=e,e={}),c.isNone(f))return!1;if(c.isString(b)){e.url=b;var h=this._buildUrl(a,e);return g.ajax(h,function(a){a.url=b,f(a)}),!0}if(c.isArray(b)){if(0===b.length)return!1;var i=new g.Keeper(b,f),j=g.batch(b,10),k=function(a,b){return function(d){c.each(b,function(b,c){var e=d[c];e.original_url=b,a.each(e)})}};return c.each(j,function(b){e.urls=c.map(b,function(a){return encodeURIComponent(a)}).join(",");var d=this._buildUrl(a,e);g.ajax(d,k(i,b))},this),!0}return f({type:"error"}),!1},g.API.prototype.oembed=function(a,b,c){return this._data("1/oembed",a,b,c)},g.API.prototype.extract=function(a,b,c){return this._data("1/extract",a,b,c)},g.API.prototype.event=function(a,b){var c="api-"+g.random(10)+".embed.ly",d=this.protocol+"//"+c+"/1/e",e=d+"?"+g.safeCreateQuery(a);g.ajax(e,b)},g.APP=function(){},g.APP.prototype.orgs=function(a){var b=f.EMB_APP_API+"/api/stats";g.ajax(b,a,!0)},g.Media=function(){this.init()},g.Media.prototype.init=function(){this.base="https://t.embed.ly/1/analytics/media"},g.Media.prototype.of=function(a,b,d){c.assert(b.start,"start date needed"),c.assert(b.end,"end date needed"),c.assert(b.filter,"filter needed");var e=this.base+"/of/url/"+encodeURIComponent(a)+"/stats";e+="?"+g.safeCreateQuery(b),g.ajax(e,d)},g.Media.prototype.urls=function(a,b){c.assert(a.start,"start date needed"),c.assert(a.end,"end date needed"),c.assert(a.key,"key needed");var d=this.base+"/urls?"+g.safeCreateQuery(a);g.ajax(d,b)},g.Media.prototype.refs=function(a,b,d){c.assert(b.start,"start date needed"),c.assert(b.end,"end date needed"),c.assert(b.key,"key needed");var e=this.base+"/of/url/"+encodeURIComponent(a)+"/urls";e+="?"+g.safeCreateQuery(b),g.ajax(e,d)},g.Cards=function(){this.init()},g.Cards.prototype.init=function(){this.base="https://t.embed.ly/1/analytics/cards"},g.Cards.prototype.of=function(a,b,d){c.assert(b.start,"start date needed"),c.assert(b.end,"end date needed"),c.assert(b.filter,"filter needed");var e=this.base+"/of/url/"+encodeURIComponent(a)+"/stats";e+="?"+g.safeCreateQuery(b),g.ajax(e,d)},g.Cards.prototype.recommend=function(a,b){c.assert(a.source,"source needed"),c.assert(a.embed,"embed needed"),c.assert(a.key,"key needed");var d=this.base+"/recommend?"+g.safeCreateQuery(a);g.ajax(d,b)},g.Display=function(){},g.Display.prototype._buildUrl=function(a,b,d){var e={key:f.EMB_API_KEY,url:b},h=c.extend(e,c.isNone(d)?{}:d),i="://i-cdn.embed.ly/1/display"+("display"===a?"":"/"+a);return(f.EMB_HTTPS?"https":"http")+i+"?"+g.safeCreateQuery(h)},g.Display.prototype.display=function(a,b){return this._buildUrl("display",a,b)},g.Display.prototype.crop=function(a,b){return this._buildUrl("crop",a,b)},g.Display.prototype.resize=function(a,b){return this._buildUrl("resize",a,b)},g.api=function(a){return new g.API(a)},g.app=function(){return new g.APP},g.media=function(){return new g.Media},g.cards=function(){return new g.Cards},g.display=function(){return new g.Display},b.exports=g}()},{"./browser.js":3,"./json.js":7,"./utils.js":23,conf:"AqyHQT"}],3:[function(a,b,c){var d=a("./utils.js"),e=a("./dom.js"),f=a("./urlparse.js"),g=a("conf"),h={};h.supports={_test:function(a){var b=["Webkit","Moz","O","ms","Khtml"],c=document.createElement("div"),e=a.charAt(0).toUpperCase()+a.substr(1),f=[a];d.each(b,function(a){f.push(a+e)});for(var g=0;g<f.length;g++)if(""===c.style[f[g]])return!0;return!1},postMessage:function(){return!!window.postMessage},boxShadow:function(){return h.supports._test("boxShadow")},borderRadius:function(){return h.supports._test("borderRadius")},touch:function(){return!!("ontouchstart"in window)},svg:function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},mediaQuery:function(){return!("undefined"==typeof window.matchMedia&&"undefined"==typeof window.msMatchMedia)},rgba:function(){var a=document.createElement("div"),b=a.style.color;try{a.style.color="rgba(1,5,13,0.44)"}catch(c){}return a.style.color!==b},cors:function(){if("undefined"==typeof XMLHttpRequest)return!1;var a=new XMLHttpRequest;return"withCredentials"in a?!0:"undefined"!=typeof XDomainRequest?!0:!1},flash:function(){if("undefined"!=typeof navigator.plugins&&0!==navigator.plugins.length)return!!navigator.plugins["Shockwave Flash"];try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(a){return!1}},canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}},h.detect=function(){var a=function(a,b){b?e.addClass(document.body,a):e.addClass(document.body,"no-"+a)};a("touch",h.supports.touch()),a("boxshadow",h.supports.boxShadow()),a("borderradius",h.supports.borderRadius()),a("rgba",h.supports.rgba()),a("mediaquery",h.supports.mediaQuery())},h.console={_log:function(a,b){if(g.EMB_DEBUG&&!d.isNone(window.console)&&window.console)if(window.console[a].apply)window.console[a].apply(window.console,b);else{var c=Array.prototype.join.call(b,", ");window.console[a](c)}},log:function(){this._log("log",arguments)},error:function(){this._log("error",arguments)}},h.open=function(a,b,c,e,f,g){if(d.isNone(f)||d.isNone(g)){var i=h.window.center(c,e);f=i.top,g=i.left}var j=window.open(a,b,"scrollbars=no, resizable=1, width="+c+", height="+e+", top="+f+", left="+g);window.focus&&j.focus()},h.cookie={set:function(a,b,c,d){var e="";if(c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),e="; expires="+f.toGMTString()}document.cookie=a+"="+b+e+"; path=/"+(d?"; secure":"")},get:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},del:function(a){h.cookie.set(a,"",-1)}},h.window={innerHeight:function(){return d.isNone(window.innerHeight)?document.documentElement.clientHeight:window.innerHeight},innerWidth:function(){return d.isNone(window.innerWidth)?document.documentElement.clientWidth:window.innerWidth},scrollY:function(){return d.isNone(window.pageYOffset)?(document.documentElement||document.body.parentNode||document.body).scrollTop:window.pageYOffset},center:function(a,b){var c=void 0!==window.screenLeft?window.screenLeft:screen.left,d=void 0!==window.screenTop?window.screenTop:screen.top,e=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,f=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,g=e/2-a/2+c,h=f/2-b/2+d;return{left:g,top:h}}},h.location={hash:function(){var a=window.location.href.split("#");return 2===a.length?a[1]:""},params:function(){return d.extend({},f.parseQuery(document.location.search),f.parseQuery(h.location.hash()))}},h.mobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},h.isIE=function(){return/msie|trident/i.test(navigator.userAgent)},h.language=function(){return window.navigator.userLanguage||window.navigator.language},h.animateScroll=function(a,b){var c,d,f=h.window.scrollY(),g=a-f,i=(new Date).getTime(),j=!1;b=b?b:500;var k=Math.round(g/b*10),l=function(b){return b>a};0>k&&(l=function(b){return a>b});var m=function(){clearInterval(c),h.console.log("duration",(new Date).getTime()-i),e.detachEvent("scroll",d)};c=setInterval(function(){return f+=k,l(f)?(m(),!1):(window.scrollTo(0,f),void(j=!0))},10),d=function(a){j&&f!==h.window.scrollY()&&m()},e.addEvent("scroll",d)},b.exports=h},{"./dom.js":5,"./urlparse.js":21,"./utils.js":23,conf:"AqyHQT"}],4:[function(a,b,c){var d={obj:function(a,b,c,d){if(void 0===b&&void 0===c)return a;var e={};return e[d[0]]=a,e[d[1]]=b,e[d[2]]=c,e},rgbToHsl:function(a,b,c){var d=this.obj(a,b,c,"rgb");a=d.r/255,b=d.g/255,c=d.b/255;var e,f,g=Math.max(a,b,c),h=Math.min(a,b,c),i=(g+h)/2;if(g===h)e=f=0;else{var j=g-h;switch(f=i>.5?j/(2-g-h):j/(g+h),g){case a:e=(b-c)/j+(c>b?6:0);break;case b:e=(c-a)/j+2;break;case c:e=(a-b)/j+4}e/=6}return this.obj(e,f,i,"hsl")},hslToRgb:function(a,b,c){var d=this.obj(a,b,c,"hsl");a=d.h,b=d.s,c=d.l;var e,f,g;if(0===b)e=f=g=c;else{var h=function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a},i=.5>c?c*(1+b):c+b-c*b,j=2*c-i;e=h(j,i,a+1/3),f=h(j,i,a),g=h(j,i,a-1/3)}return this.obj(Math.round(255*e),Math.round(255*f),Math.round(255*g),"rgb")},rgbToHex:function(a,b,c){var d=this.obj(a,b,c,"rgb");return"#"+((1<<24)+(d.r<<16)+(d.g<<8)+d.b).toString(16).slice(1)},hexToRgb:function(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},segment:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push(this.rgbToHsl(d[0],d[1],d[2]))}b.sort(function(a,b){return a.l-b.l});var e={};e.lightest=this.hslToRgb(b[b.length-1]),e.darkest=this.hslToRgb(b[0]);for(var f=!0,g=0;g<b.length;g++){var h=b[g];if(0!==h.s||0!==h.h){f=!1;break}}return f?e.colorful=e.darkest:(b.sort(function(a,b){return a.l+2*a.s+a.h/5-(b.l+2*b.s+b.h/5)}),e.colorful=this.hslToRgb(b[b.length-1])),e}};b.exports=d},{}],5:[function(a,b,c){var d=a("./utils.js"),e={};e.toArray=function(a){return d.map(a,function(a){return a})},e.all=function(a,b){var c=[];return document.querySelectorAll?e.toArray(document.querySelectorAll(a)):c},e.one=function(a,b){var c=e.all(a,b);return 0===c.length?null:c[0]},e.create=function(a,b,c,f){if(!a||!d.isString(a))return null;d.isString(b)&&d.isNone(c)&&(c=b,b={});var g;return g=f?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a),d.each(b,function(a,b){g.setAttribute(b,a)}),c&&e.text(g,c),g},e.set=function(a,b,c){if(!a||!d.isString(a))return null;d.isString(b)&&d.isNone(c)&&(c=b,b={});var f=e.one(a);return f?(d.each(b,function(a,b){f.setAttribute(b,a)}),d.isNone(c)||e.text(f,c),f):null},e.replace=function(a,b){d.assert(d.isElement(a),"replace requires an element to be replaced"),d.assert(d.isElement(b),"replace requires an element to replace with."),a.parentNode.replaceChild(b,a)},e.remove=function(a){return d.isElement(a)&&d.isElement(a.parentNode)?void a.parentNode.removeChild(a):!1},e.hide=function(a){return d.isString(a)&&(a=e.one(a)),d.isElement(a)&&(a.style.display="none"),a},e.show=function(a,b){return d.isString(a)&&(a=e.one(a)),d.isElement(a)&&(a.style.display=b?"inline-block":"block"),a},e.svg=function(a,b,c){return e.create(a,b,c,"http://www.w3.org/2000/svg")},e.children=function(a,b){return d.isElement(a)?d.reduce(a.childNodes,function(a,c){if(d.isElement(c)){if(!d.isNone(b))if(c.namespaceURI&&"http://www.w3.org/2000/svg"===c.namespaceURI){if(c.nodeName!==b)return a}else if(b.toUpperCase()!==c.nodeName)return a;a.push(c)}return a},[]):[]},e.child=function(a,b){var c=e.children(a,b);return 0!==c.length?c[0]:null},e.text=function(a,b){if(!a||!d.isElement(a))return null;if(d.isNone(b))return a.innerText||a.textContent;var c=void 0===a.textContent?"innerText":"textContent";a[c]=b},e.hasClass=function(a,b){if(d.isString(a)&&(a=e.one(a)),!d.isElement(a)||!d.isString(b)||!b)return!1;var c=a.getAttribute("class");return d.isNone(c)?!1:(" "+c+" ").indexOf(" "+b+" ")>-1?!0:!1},e.addClass=function(a,b){if(d.isString(a)&&(a=e.one(a)),!d.isElement(a)||!d.isString(b)||!b)return!1;if(e.hasClass(a,b))return!1;var c=a.getAttribute("class");if(d.isNone(c))return a.setAttribute("class",b),!0;var f=c.split(" "),g=[];return d.map(f,function(a){var b=d.trim(a);""!==b&&g.push(b)}),g.push(b),a.setAttribute("class",g.join(" ")),!0},e.removeClass=function(a,b){if(d.isString(a)&&(a=e.one(a)),!d.isElement(a)||!d.isString(b)||!b)return!1;var c=a.getAttribute("class");if(d.isNone(c))return!1;var f=!1,g=d.reduce(c.split(" "),function(a,c){var e=d.trim(c);return e?e===b?(f=!0,a):(a.push(e),a):a},[]);return a.setAttribute("class",g.join(" ")),f},e.data=function(a,b,c){d.assert(a&&d.isElement(a),"dom.data needs an element."),d.assert(b&&d.isString(b),"dom.data needs an attr.");var e=d.camelCase(b);return d.isNone(c)?d.isNone(a.dataset)?a.getAttribute("data-"+b):d.isNone(a.dataset[e])?null:a.dataset[e]:void(d.isNone(a.dataset)?a.setAttribute("data-"+b,c):a.dataset[e]=c)},e.attrize=function(a){return a&&d.isObject(a)?d.map(a,function(a,b){return b+'="'+a+'"'}).sort().join(" "):""},e.event=function(a){var b=d.extend({},a||window.event);return b.target||(b.target=b.srcElement||document),3===b.target.nodeType&&(b.target=b.target.parentNode),!a.metaKey&&a.ctrlKey&&(b.metaKey=b.ctrlKey),b.stop=function(){a.preventDefault?a.preventDefault():a.returnValue=!1},b.pageX||b.pageY||!b.clientX&&!b.clientY||(b.pageX=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b.pageY=b.clientY+document.body.scrollTop+document.documentElement.scrollTop),b},e.addEvent=function(a,b,c){d.isNone(a)||(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)},e.detachEvent=function(a,b,c){d.isNone(a)||(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null)},e.trigger=function(a,b){d.assert(d.contains(["click"],b),"Not a valid event");var c;a.dispatchEvent?(c=document.createEvent("MouseEvents"),c.initEvent(b,!0,!0),a.dispatchEvent(c,!0)):(c=document.createEventObject(),a.fireEvent("on"+b,c))},e.rect=function(a){try{return a.getBoundingClientRect()}catch(b){}return!1},b.exports=e},{"./utils.js":23}],6:[function(a,b,c){var d=a("./utils.js"),e=a("./dom.js"),f=a("./colors.js"),g={};g.Graph=function(a,b,c){return this.init(a,b,c)},g.Graph.ATTRS=["load","view","hover","play","click"],g.Graph.COLORS=["#3A7990","#fc6608","#521836","#f13d2f"],g.Graph.defaults={height:100,group:"unique",barPadding:.75,marginBottom:15,marginLeft:25,trim:!1,interval:"hour"},g.max=function(a,b){var c;return d.reduce(a,function(a,e){return c=d.isNone(b)?e:d.get(e,b,0),a>c?a:c},0)},g.min=function(a,b){var c;return d.reduce(a,function(a,e){return c=d.isNone(b)?e:d.get(e,b),null===c?null:null===a?c:c>a?a:c},null)},g.sum=function(a,b){var c;return d.reduce(a,function(a,e){return c=d.isNone(b)?e:d.get(e,b,0),c?a+c:a},0)},g.splitter=function(a,b,c,d){c=c?c:1;var e=Math.floor(a*c/b),f=e.toString().length,h=Math.pow(5,f-1);e-=e%h,1>e&&(e=1);for(var i,j=[],k=1;b>=k;k++)i=e*k,a>i&&j.push(e*k);if(!d){var l=g.splitter(a,b-1,c,!0);if(l[l.length-1]>j[j.length-1])return l}return j},g.playtime=function(a,b){if(!a||!d.isNumber(a))return a;var c=["y","d","h","m","s"];b=d.isNone(b)?c.length:b;var e,f=31536e3,g=86400,h=3600,i=60,j=1,k=0,l=d.map([f,g,h,i,j],function(b){return e=Math.floor((a-k)/b),k+=e*b,e});return d.trim(d.reduce(l,function(a,b,d){return b?(a.push(b+c[d]),a):a},[]).slice(0,b).join(" "))},g.date=function(a){var b=parseInt(a.substr(0,4),10),c=parseInt(a.substr(4,2),10),d=parseInt(a.substr(6,2),10),e=parseInt(a.substr(8,2),10),f=parseInt(a.substr(10,2),10),g=new Date;return g.setFullYear(b),g.setMonth(c+1),g.setDate(d),g.setHours(e),g.setMinutes(f),g.setSeconds(0),g.setMilliseconds(0),g},g.localize=function(a){var b=g.date(a);b.setMinutes(b.getMinutes()-b.getTimezoneOffset());var c=function(a){return(10>a?"0":"")+a};return[b.getFullYear(),c(b.getMonth()-1),c(b.getDate()),c(b.getHours()),c(b.getMinutes())].join("")},g.hourFmt=function(a){var b=parseInt(a.substr(8,2),10),c=parseInt(a.substr(10,2),10);return 0===b?b=12:b>12&&(b-=12),10>c&&(c="0"+c),[b,c].join(":")},g.currentInterval=function(a){var b,c=g.date(a[0].time),d=g.date(a[1].time),e=(d-c)/1e3;return b=60===e?"minute":3600===e?"hour":"day"},g.merge=function(a){var b,c=["hover","load","play","progress","click","total"],e={actions:c,unique:c,media:["total"]},f=d.reduce(a,function(a,c){return d.each(e,function(e,f){d.each(e,function(e){b=d.get(c[f],e,0),a[f].hasOwnProperty(e)?a[f][e]+=b:a[f][e]=b})}),!a.media.duration&&c.media.duration&&(a.media.duration=c.media.duration),a},{actions:{},unique:{},media:{}});return f.media.total&&f.unique.play&&(f.media.average_playtime=Math.floor(f.media.total/f.unique.play)),f},g.normalize=function(a,b,c){var e=["minute","hour","day"];d.assert(d.contains(e,b),'Not a valid interval: "'+b+'"');var f=g.currentInterval(a);d.assert(d.indexOf(e,f)<=d.indexOf(e,b),"Cannot convert down an interval. i.e. hours to minutes");var h=function(a){return d.reduce(g.Graph.ATTRS,function(b,c){return b+d.get(a,c,0)},0)},i=[],j=!1;if(d.each(a,function(a){return a=d.extend({},a),a.time=g.localize(a.time),a.actions.total=h(a.actions),a.unique.total=h(a.unique),c&&!j&&0===a.actions.total&&0===a.unique.total?!0:(j=!0,a.media.total=d.get(a.media,"average_playtime",0)*d.get(a.unique,"play",0),void i.push(a))},this),f===b)return i;if("hour"===f&&"day"===b){var k,l={},m=[];d.each(i,function(a){k=a.time.substr(0,8)+"0000",d.contains(m,k)||m.push(k),l.hasOwnProperty(k)?l[k].push(a):l[k]=[a]});var n;return d.map(m,function(a){return n=g.merge(l[a]),n.time=a,n})}d.assert(!1,"Normalized failed.")},g.watched=function(a){return d.reduce(a,function(a,b){b=d.extend({},b);var c=d.get(b,"media.watched",[]);return d.isArray(c)&&0!==c.length?0===a.length?c.slice(0):a.length!==c.length?a:d.map(a,function(a,b){return a+c[b]}):a},[])},g.Graph.prototype.init=function(a,b,c){this.parent=a,this.options=d.extend({},g.Graph.defaults,c?c:{}),this.options.width=d.get(this.options,"width",a.offsetWidth),this.data=g.normalize(b,this.options.interval,this.options.trim)},g.Graph.prototype.entry=function(a){return"media"===this.options.group?a.media:"actions"===this.options.group?a.actions:a.unique},g.Graph.prototype.max=function(a){if(a=d.isNone(a)?"total":a,a=d.isArray(a)?a:[a],0===a.length)return 0;var b,c,e;return d.reduce(this.data,function(f,g){return c=this.entry(g),b="total"===a[0]?c.total:d.reduce(a,function(a,b){return e=d.get(this.entry(g),b,0),e+a},0,this),b>f?b:f},0,this)},g.Graph.prototype.xAxisTicks=function(){var a;return"day"===this.options.interval?d.reduce(this.data,function(b,c,e){return a=d.map([c.time.substr(4,2),c.time.substr(6,2)],function(a){return"0"===a.substr(0,1)?a.substr(1):a}).join("/"),b.push({value:e,text:a}),b},[]):"hour"===this.options.interval?d.reduce(this.data,function(b,c,e){return"0000"===c.time.substr(8)&&e>2&&(a=d.map([c.time.substr(4,2),c.time.substr(6,2)],function(a){return"0"===a.substr(0,1)?a.substr(1):a}).join("/"),b.push({value:e,text:a})),b},[]):"minute"===this.options.interval?d.reduce(this.data,function(a,b,c){return parseInt(b.time.substr(10,2),10)%10===0&&c>4&&a.push({value:c,text:g.hourFmt(b.time)}),a},[]):void 0},g.Graph.prototype.xAxis=function(a,b,c,f){var g=this.options.height,h=this.options.marginBottom;f=d.isNone(f)?this.barWidth():f,c=d.isNone(c)?this.xAxisTicks():c;var i,j;d.each(c,function(c){var k=d.isNone(c.buffer)?3*c.text.length:c.buffer;i=e.svg("text",{"class":"x-axis-text",x:b(c.value)+f/2-k,y:g}),e.text(i,c.text),a.appendChild(i),j=e.svg("line",{"class":"x-axis",x1:b(c.value)+f/2,y1:g-h+5,x2:b(c.value)+f/2,y2:g-h}),a.appendChild(j)})},g.Graph.prototype.yAxis=function(a,b,c){var f=this.options.height,h=this.options.width,i=this.options.marginBottom,j=this.options.marginLeft,k=this.max(c),l=[];l=0===k?[0]:g.splitter(k,3,.9);var m,n;d.each(l,function(c){m=e.svg("text",{"class":"y-axis-text",x:1,y:f-b(c)-i+3}),"media"===this.options.group?e.text(m,g.playtime(c,1)):e.text(m,c),a.appendChild(m),n=e.svg("line",{"class":"y-axis-line",x1:j,x2:h,y1:f-b(c)-i,y2:f-b(c)-i}),a.appendChild(n)},this)},g.Hover=function(a,b,c,d){this.init(a,b,c,d)},g.Hover.prototype.init=function(a,b,c,f){this.data=a,this.svg=c,this.wrapper=b,this.xaxis=[],this.rectangles={},this.options=f,this.props=g.Graph.ATTRS;var h=this.options.width,i=this.options.barPadding,j=this.data.length,k=this.options.marginLeft,l=(h-k-j*i)/j,m=function(a){return Math.floor((a-k)/(l+i))};e.addEvent(this.wrapper,"mousemove",d.bind(function(a){this.xaxis=this.xaxis.sort(function(a,b){return a-b});for(var b=e.event(a),c=this.wrapper.getBoundingClientRect(),f={top:b.pageY-c.top,left:b.pageX-c.left},g=f.left,h=m(g),i=[],j=h-3;h+3>j;j++)i.push(this.xaxis[j]);var k=d.reduce(i,function(a,b){return Math.abs(b-g)<Math.abs(a-g)?b:a},-1e3),l=this.rectangles[k];return l?void this.hovered(b,l,f):!1},this)),e.addEvent(this.wrapper,"mouseleave",d.bind(function(){this.clearHover()},this))},g.Hover.prototype.add=function(a,b,c,d){this.rectangles[d]={obj:a,entry:b,elems:c,x:d},this.xaxis.push(d)},g.Hover.prototype.clearHover=function(){d.each(e.all(".line-active"),function(a){e.remove(a)}),d.each(e.all(".graph-hover"),function(a){e.remove(a)})},g.Hover.prototype.hovered=function(a,b,c){this.clearHover();var f=(this.options.width-this.data.length*this.options.barPadding)/this.data.length,h=b.x+f/2;this.svg.appendChild(e.svg("line",{"class":"line-active",x1:h,x2:h,y1:0,y2:this.options.height-this.options.marginBottom,stroke:"#444","stroke-width":"1"}));var i=d.map([4,6,8],function(a){var c=b.obj.time.substr(a,2);return"0"===c.substr(0,1)?c.substr(1):c}),j=i[0]+"/"+i[1]+" at "+g.hourFmt(b.obj.time),k=e.create("div",{"class":"graph-hover"}),l=['<h4 class="graph-header">'+j+"</h4>"];"media"===this.options.group?l=l.concat(["<dl>","<dt>Playtime:</dt>","<dd>"+g.playtime(d.get(b.entry,"total","n/a"),2)+"</dd>","<dt>Duration:</dt>","<dd>"+g.playtime(d.get(b.entry,"duration","n/a"),2)+"</dd>","<dt>Average:</dt>","<dd>"+g.playtime(d.get(b.entry,"average_playtime","n/a"),2)+"</dd>","</dl>"]):(l.push("<dl>"),d.each(this.props,function(a){l.push("<dt>"+d.capitalize("load"===a?"view":a)+"s:</dt>"),l.push("<dd>"+d.get(b.entry,a,"0")+"</dd>")},this),l.push("</dl>")),k.innerHTML=l.join(" ");var m=this.wrapper.getBoundingClientRect(),n=c.top<50?50:c.top;n=n+50>m.height?m.height-50:n;var o=h+130>m.width?h-115:h+10;k.style.top=n-50+"px",k.style.left=o+"px",this.wrapper.appendChild(k)},g.Graph.prototype.barWidth=function(){var a=this.options.width,b=this.options.barPadding,c=this.data.length,d=this.options.marginLeft;return(a-d-c*b)/c},g.Graph.prototype.bar=function(a){d.isNone(a)||(a=d.isArray(a)?a:[a],d.each(a,function(a){d.assert(d.contains(["load","hover","view","play","click"],a),"Invalid prop")}));var b=this.options.width,c=this.options.height,f=this.max(a),h=this.options.barPadding,i=(this.data.length,this.options.marginBottom),j=this.options.marginLeft,k=this.barWidth(),l=function(a){return a*(k+h)+j},m=function(a,b){return 0===f?0:a*((c-i)/f)},n=e.create("div",{id:"graph","class":"graph-wrapper"});n.style.width=b+"px",n.style.height=c+"px";var o=e.svg("svg",{"class":"graph-svg",width:b,height:c});this.options.label!==!1&&(this.xAxis(o,l),this.yAxis(o,m,a));var p;p=this.options.label!==!1?new g.Hover(this.data,n,o,this.options):{add:function(){}};var q;return d.each(this.data,function(b,f){var h=this.entry(b);if(0===h.total)return p.add(b,h,[],l(f),c-i),!0;var j,n,r=0,s=[],t=function(a,b){return{"class":"rect-"+a,"data-prop":a,width:k,height:b,x:l(f),y:c-b-r-i}};"media"===this.options.group?s.push(t("playtime",m(h.total))):d.each(g.Graph.ATTRS,function(b,c){return d.isNone(a)||d.contains(a,b)?(j=d.get(h,b,0),0===j?!0:(n=m(j),s.push(t(b,n)),void(r+=n))):!0});var u=d.map(s,function(a){return q=e.svg("rect",a),o.appendChild(q),q});p.add(b,h,u,l(f),c-i)},this),n.appendChild(o),this.parent.appendChild(n),setTimeout(function(){e.addClass(n,"graph-show")},20),p},g.Graph.prototype.heat=function(){{var a=this.options.width,b=this.options.height,c=this.options.marginBottom,h=g.watched(this.data);g.sum(this.data,"unique.play")}if(0===h.length)return null;var i=g.max(h),j=(g.min(h),d.map(h,function(a){return Math.round(a/i*100)})),k=function(a){var b=function(a){return.6*(1-a/100)+.3},c=function(a){return(1-a/100)*(1/6)};return f.rgbToHex(f.hslToRgb(c(a),1,b(a)))},l=a/h.length,m=function(a){return a*l},n=function(a){return 0===i?0:a*((b-c)/100)},o=e.create("div",{id:"graph","class":"graph-wrapper graph-heat"});o.style.width=a+"px",o.style.height=b+"px";var p=e.svg("svg",{"class":"graph-svg",width:a,height:b}),q=[];d.each(j,function(a,d){q=e.svg("rect",{"class":"rect-heat",width:l,height:n(a),x:m(d),y:b-n(a)-c,fill:k(a)}),p.appendChild(q)});var r,s=g.max(this.data,"media.duration"),t=d.map(g.splitter(s,10),function(b){return r=b*(a/s),{value:r,text:g.playtime(b)}},this);return t.splice(0,0,{value:0,text:"0",buffer:0}),this.options.label!==!1&&this.xAxis(p,function(a){return a},t,0),o.appendChild(p),this.parent.appendChild(o),setTimeout(function(){e.addClass(o,"graph-show")},20),{wrapper:o,svg:p}},b.exports=g},{"./colors.js":4,"./dom.js":5,"./utils.js":23}],7:[function(a,b,c){var d=a("./browser.js");b.exports=function(a){function b(a){return 10>a?"0"+a:a}function c(a){return h.lastIndex=0,h.test(a)?'"'+a.replace(h,function(a){var b=i[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(a,e){var h,i,j,k,l,m=f,n=e[a];switch(n&&"[object Date]"===Object.prototype.toString.call(n)&&(n=isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null),typeof n){case"string":return c(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(f+=g,l=[],"[object Array]"===Object.prototype.toString.apply(n)){for(k=n.length,h=0;k>h;h+=1)l[h]=d(h,n)||"null";return j=0===l.length?"[]":f?"[\n"+f+l.join(",\n"+f)+"\n"+m+"]":"["+l.join(",")+"]",f=m,j}for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(j=d(i,n),j&&l.push(c(i)+(f?": ":":")+j));return j=0===l.length?"{}":f?"{\n"+f+l.join(",\n"+f)+"\n"+m+"}":"{"+l.join(",")+"}",f=m,j}}var e={};if(window.JSON&&JSON.parse&&JSON.stringify)return window.JSON;var f,g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return e.stringify=function(a,b){var c;if(f="",g="","number"==typeof b)for(c=0;b>c;c+=1)g+=" ";else"string"==typeof b&&(g=b);return d("",{"":a})},e.parse=function(){var b,c,d,e,f={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},g=function(c){a.console.error({name:"SyntaxError",message:c,at:b,text:d})},h=function(a){return a&&a!==c&&g("Expected '"+a+"' instead of '"+c+"'"),c=d.charAt(b),b+=1,c},i=function(){var a,b="";for("-"===c&&(b="-",h("-"));c>="0"&&"9">=c;)b+=c,h();if("."===c)for(b+=".";h()&&c>="0"&&"9">=c;)b+=c;if("e"===c||"E"===c)for(b+=c,h(),("-"===c||"+"===c)&&(b+=c,h());c>="0"&&"9">=c;)b+=c,h();return a=+b,isFinite(a)?a:void g("Bad number")},j=function(){var a,b,d,e="";if('"'===c)for(;h();){if('"'===c)return h(),e;if("\\"===c)if(h(),"u"===c){for(d=0,b=0;4>b&&(a=parseInt(h(),16),isFinite(a));b+=1)d=16*d+a;e+=String.fromCharCode(d)}else{if("string"!=typeof f[c])break;e+=f[c]}else e+=c}g("Bad string")},k=function(){for(;c&&" ">=c;)h()},l=function(){switch(c){case"t":return h("t"),h("r"),h("u"),h("e"),!0;case"f":return h("f"),h("a"),h("l"),h("s"),h("e"),!1;case"n":return h("n"),h("u"),h("l"),h("l"),null}g("Unexpected '"+c+"'")},m=function(){var a=[];if("["===c){if(h("["),k(),"]"===c)return h("]"),a;for(;c;){if(a.push(e()),k(),"]"===c)return h("]"),a;h(","),k()}}g("Bad array")},n=function(){var a,b={};if("{"===c){if(h("{"),k(),"}"===c)return h("}"),b;for(;c;){if(a=j(),k(),h(":"),Object.hasOwnProperty.call(b,a)&&g('Duplicate key "'+a+'"'),b[a]=e(),k(),"}"===c)return h("}"),b;h(","),k()}}g("Bad object")};return e=function(){switch(k(),c){case"{":return n();case"[":return m();case'"':return j();case"-":return i();default:return c>="0"&&"9">=c?i():l()}},function(a){var f;return d=a,b=0,c=" ",f=e(),k(),c&&g("Syntax error"),f}}(),e}(d)},{"./browser.js":3}],8:[function(a,b,c){var d=a("./utils.js"),e=function(){this.init()};e.prototype.init=function(){this.len=0,this.count=0,this.results={},this.finished=!1,this.started=!1},e.prototype.callback=function(){var a=this.len;return this.len++,d.bind(function(b){this.each(a,b)},this)},e.prototype.done=function(){if(!this.started)return!1;if(this.finished)return!0;if(this.count===this.len){this.finished=!0;for(var a=[],b=0;b<this.len;b++)a.push(this.results[b]);return this.func.call(this.ctx,a),!0}},e.prototype.each=function(a,b){this.results[a]=b,this.count++,this.done()},e.prototype.wait=function(a,b){this.func=a,this.ctx=b?b:null,this.started=!0,this.done()},b.exports=e},{"./utils.js":23}],9:[function(a,b,c){var d=a("./utils.js"),e={};e.intervals=[5,10,15,30],e.sequence=function(a){if(a.length<2)return[];for(var b,c,e,f=[],g=[],h=0;h<a.length;h++)if(c=a[h],d.isNone(b))f.push(c),b=c;else{if(e=c-b,e>2||-2>e?(g.push(f),f=[c]):f.push(c),
h===a.length-1){g.push(f);break}b=c}var i,j,k=[];return d.each(g,function(a){a.length>2&&(i=Math.round(a[a.length-1]),j=Math.round(a[0]),k.push({start:j,end:i,duration:i-j}))}),k},e.stringify=function(a){if(0===a.length)return null;var b=[];return d.each(a,function(a){!d.isNone(a)&&d.isNumber(a.start)&&d.isNumber(a.end)&&b.push(Math.round(a.start)+"-"+Math.round(a.end))}),0===b.length?null:b.join(",")},e.Progress=function(a,b){this.init(a,b)},e.Progress.prototype.init=function(a,b){this.started=!1,this.killed=!1,this._timeout=null,this.hub=a,this.type=b,this._interval=0,this._pace=1e3,this.times=[],this.last=null},e.Progress.prototype.nextInterval=function(){var a;return a=this._interval>=e.intervals.length-1?e.intervals[e.intervals.length-1]:e.intervals[this._interval],this._interval++,a},e.Progress.prototype.start=function(){return this.killed?!1:(this.started=!0,void(this._timeout=setTimeout(d.bind(function(){this.emit()},this),this.nextInterval()*this._pace)))},e.Progress.prototype.clear=function(){clearTimeout(this._timeout),this.started=!1,this.times=[]},e.Progress.prototype.kill=function(){this.clear(),this.killed=!0},e.Progress.prototype.emit=function(a){var b=this.times;this.times=[],a!==!1&&this.start();var c=e.sequence(b);if(0===c.length)return!1;if(c.length>1)return this.hub.notify(this.type+".progress.data",{times:c,duration:this.duration}),!0;var d=c[0];null!==this.last&&this.last.end&&Math.abs(d.start-this.last.end)<3&&(d.start=this.last.end),this.last=d,this.hub.notify(this.type+".progress.data",{times:[d],duration:this.duration})},e.Progress.prototype.delegate=function(a,b){d.each(this._listeners[a],d.bind(function(a){a.call(this,b)},this))},e.Progress.prototype.on=function(a,b){this._listeners.hasOwnProperty(a)?this._listeners[a].push(b):this._listeners[a]=[b]},e.Progress.prototype.timeupdate=function(a){if(this.killed)return!1;this.times.push(a.seconds);var b=d.isNone(a.duration)?null:Math.floor(a.duration);d.isNone(a.duration)||this.duration===b||(d.isNone(this.duration)?this.duration=b:this.kill()),this.started||this.start()},e.Progress.prototype.ended=function(){return this.killed?!1:void(this.duration&&this.duration>61&&(clearTimeout(this._timeout),this.emit(!1)))},e.Progress.prototype.update=function(a){return this.killed?!1:(this.times.push(a),void(this.started||this.start()))},e.media=function(a){var b=new e.Progress(a,"media");return a.on("media.timeupdate",function(a){b.timeupdate(a)}),a.on("media.ended",function(){b.ended()}),b},e.page=function(a,b,c){var d=new e.Progress(a,"page");b=b?b:1,c=c?c:1e3,d._pace=c;var f=0,g=function(a){d.update(a)};g(0);var h=setInterval(function(){f+=b,f>12e5&&(d.ended(),clearInterval(h)),g(f)},c);return a.on("page.progress.clear",function(){d.ended(),clearInterval(h)}),d},b.exports=e},{"./utils.js":23}],10:[function(a,b,c){var d=a("./utils.js"),e=a("./dom.js"),f=a("./browser.js"),g=(a("./urlparse.js"),a("conf")),h=a("./json.js"),i={};i.connect=function(a){var b=f.location.params(),c=b.sid;return g.EMB_POST_MESSAGE?(a.on("window.message",function(b,e){return d.isNone(e.sid)||e.sid===c?(f.console.log("receiver.hub.notify",e.method,e),void a.notify(e.method,e)):!1}),e.addEvent(window,"message",function(b){if("__ready__"===b.data)return!1;var c;try{c=h.parse(b.data)}catch(e){return!1}return d.isNone(c)?!1:void a.notify("window.message",b,c)}),void a.on("receiver.send",function(a,b){if(window.self===window.top)return!1;d.isNone(b)&&(b={}),b.method=a,b.sid=c;var e=h.stringify(b);window.parent.postMessage(e,"*")})):!1},b.exports=i},{"./browser.js":3,"./dom.js":5,"./json.js":7,"./urlparse.js":21,"./utils.js":23,conf:"AqyHQT"}],11:[function(a,b,c){var d=a("../utils.js"),e=a("../dom.js"),f=a("../graphs.js"),g=a("./init.js"),h={};h.html=['<div class="stats-actions clearfix">','<ul class="actions-tab actions-left inline-list">','<li><a href="#" class="stats-actions-group" data-group="unique" title="Unique Actions">Unique</a></li>','<li><a href="#" class="stats-actions-group" data-group="actions">Total</a></li>',"</ul>",'<ul class="actions-tab actions-right inline-list">','<li><a href="#" class="stats-actions-interval" data-interval="hour">Week</a></li>','<li><a href="#" class="stats-actions-interval" data-interval="minute">Realtime</a></li>',"</ul>","</div>",'<div class="stats-graph"></div>','<div class="stats-totals clearfix">','<ul class="totals-actions inline-list">','<li class="stats-totals-props" data-prop="load"><a href="#" class="totals-prop total-load">Visits</a><span></span></li>','<li class="stats-totals-props" data-prop="view"><a href="#" class="totals-prop total-view">Views</a><span></span></li>','<li class="stats-totals-props" data-prop="hover"><a href="#" class="totals-prop total-hover">Hovers</a><span></span></li>','<li class="stats-totals-props" data-prop="play"><a href="#" class="totals-prop total-play">Plays</a><span></span></li>','<li class="stats-totals-props" data-prop="click"><a href="#" class="totals-prop total-click">Click</a><span></span></li>',"</ul>","</div>"].join(""),h.title=['<a href="#" class="stats-back">&lt; Back</a>','<h4>Impressions | <span class="stats-range"></span></h4>'].join(""),h.graph=function(a,b){var c=e.one(".stats-graph");c.innerHTML="";var h=new f.Graph(c,a.data,b);h.bar(b.props);var i,j=a.totals;i="media"===g.group?["load","hover","play"]:d.get(j,"media.playtime")?["load","view","hover","play","click"]:["load","view","hover","click"],d.each(e.all(".stats-totals-props"),function(a){var c=e.child(a,"span"),f=e.data(a,"prop");e.text(c,g.comma(d.get(j,[b.group,f].join("."),0))),d.contains(i,f)?e.removeClass(a,"hide"):e.addClass(a,"hide")});var k;d.each(e.all(".stats-totals-props"),function(a){k=e.data(a,"prop"),d.get(j.unique,k)?e.removeClass(a,"hide"):e.addClass(a,"hide"),d.contains(b.props,k)?e.addClass(a,"active"):e.removeClass(a,"active")});var l;d.each(e.all(".stats-actions-group"),function(a){l=e.data(a,"group"),b.group===l?e.addClass(a.parentNode,"active"):e.removeClass(a.parentNode,"active"),"media"!==l||d.get(j.media,"playtime")?"media"===l&&e.removeClass(a.parentNode,"hide"):e.addClass(a.parentNode,"hide"),"heat"!==l||d.get(j.media,"heat")?"heat"===l&&e.removeClass(a.parentNode,"hide"):e.addClass(a.parentNode,"hide")}),d.each(e.all(".stats-actions-interval"),function(a){b.interval===e.data(a,"interval")?e.addClass(a.parentNode,"active"):e.removeClass(a.parentNode,"active")})},h.render=function(a,b){var c=e.one(".stats-block");c.innerHTML=h.html;var f=e.one(".stats-title");f.innerHTML=h.title,g.back(),b=d.extend({props:["load","view","hover","play","click"],group:"unique",interval:"hour",height:100},b?b:{}),h.graph(a,b),g.hub.off("window.resize"),g.hub.on("window.resize",function(){h.graph(a,b)}),e.set(".stats-range",a.range()),d.each(e.all(".totals-prop"),function(c){e.addEvent(c,"click",function(c){c=e.event(c),c.stop();var f=c.target.parentNode,i=e.data(f,"prop");e.hasClass(f,"active")?(e.removeClass(f,"active"),g.track("remove-prop",i)):(e.addClass(f,"active"),g.track("add-prop",i)),b.props=d.reduce(e.all(".stats-totals-props"),function(a,b){return e.hasClass(b,"active")&&a.push(e.data(b,"prop")),a},[]),h.graph(a,b)})}),d.each(e.all(".stats-actions-group"),function(c){e.addEvent(c,"click",function(c){c=e.event(c),c.stop();var d=c.target.parentNode,f=e.data(c.target,"group");return e.hasClass(d,"active")?!0:(g.track("change-group",f),b.group=f,void h.graph(a,b))})}),d.each(e.all(".stats-actions-interval"),function(a){e.addEvent(a,"click",function(a){a=e.event(a),a.stop(),g.hub.notify("stats.refresh.clear");var c=e.data(a.target,"interval");g.track("change-interval",c),"minute"===c?g.hub.notify("stats.bar.realtime",b):g.hub.notify("stats.bar.week",b)})}),"minute"===b.interval&&(g.hub.notify("stats.refresh.start"),g.hub.off("stats.refresh"),g.hub.on("stats.refresh",function(){g.hub.notify("stats.bar.realtime",b)}))},h.connect=function(a){a.on("stats.bar.render",h.render),a.on("stats.bar.realtime",function(b){a.get("stats.data.realtime",{},function(a){b=b?b:{},b.interval="minute",h.render(a,b)})}),a.on("stats.bar.week",function(b){a.get("stats.data.week",{},function(a){b=b?b:{},b.interval="hour",h.render(a,b)})})},b.exports=h},{"../dom.js":5,"../graphs.js":6,"../utils.js":23,"./init.js":16}],12:[function(a,b,c){var d=a("../utils.js"),e=a("../dom.js"),f=a("../urlparse.js"),g=a("../keeper.js"),h=a("../browser.js"),i=a("../api.js"),j=(a("../graphs.js"),a("conf")),k=a("./init.js");a("./data.js"),a("./info.js");var l=a("./overview.js"),m=a("./bar.js"),n=a("./heatmap.js"),o=a("./refresh.js"),p=a("./loading.js");k.StatsContainer=function(a,b,c){this.init(a,b,c)},k.StatsContainer.prototype.init=function(a,b){this.hub=a,this.group=j.EMB_GROUP,this._data={}},k.StatsContainer.prototype.draw=function(){k.hover=!1;var a="stats-content"+(k.options.parent.offsetHeight<310?" stats-small":""),b="group-"+(d.isNone(this.group)?"card":this.group)+(k.options.inline?" stats-inline":"");this.wrapper=e.create("div",{id:"stats","class":b}),this.content=e.create("div",{"class":a}),k.options.parent.appendChild(this.wrapper),this.wrapper.appendChild(this.content),this.content.innerHTML=['<a href="#" class="stats-close">âœ•</a>','<div class="actions-refresh"></div>','<div class="stats-title"></div>','<div class="stats-byline"></div>','<div class="stats-block clearfix"></div>','<div class="stats-detail"></div>'].join(""),"card"!==this.group||k.options.inline||this.content.appendChild(e.create("div",{"class":"stats-triangle"}));var c=e.one(".stats-close");e.addEvent(c,"click",d.bind(function(a){var b=e.event(a);b.stop(),this.clear()},this)),this.byline(),this.details(),this.resize(),e.addEvent(window,"resize",d.bind(function(){this.resize()},this))},k.StatsContainer.prototype.resize=function(){var a=k.options.parent.offsetWidth,b=k.options.parent.offsetHeight;if(260>b?e.addClass(e.one(".stats-totals"),"disabled"):e.removeClass(e.one(".stats-totals"),"disabled"),(200>b||330>a)&&!k.options.inline){if(!e.one(".stats-error")){var c=e.create("div",{"class":"stats-error"});c.innerHTML=["<h4>The width and height of this Embed is too small for In-Embed analytics.</h4>",'<div class="stats-detail"></div>'].join(""),e.addClass(e.one(".stats-content"),"hide"),this.wrapper.appendChild(c),this.details()}}else{e.removeClass(e.one(".stats-content"),"hide");var d=e.one(".stats-error");d&&e.remove(d)}k.hub.notify("window.resize",{width:a,height:b})},k.StatsContainer.prototype.clear=function(){k.hover=!0,k.hub.notify("stats.refresh.clear"),e.remove(this.wrapper)},k.StatsContainer.prototype.byline=function(a){a=a?a:48;var b=e.one(".stats-byline"),c=k.options.url,d=k.options.filter;return d&&c&&(b.innerHTML=['<span>for: <a id="bylineURL" href="'+c+'" target="_blank" title="'+c+'">'+k.truncate(c,a)+"</a></span>",'<span>on: <a id="bylineRef" href="'+d+'" target="_blank" title="'+d+'">'+k.truncate(d,a)+"</a></span>"].join(""),k.track(e.one("#bylineURL"),"byline-url"),k.track(e.one("#bylineRef"),"byline-ref")),b},k.StatsContainer.prototype.details=function(a,b){return k.hub?void k.hub.get("xcomm.stats.access",{url:k.options.url,ref:k.options.filter,group:this.group},d.bind(function(b){if(b.access===!0){if(b&&b.url&&(b.org&&b.org.slug||b.s)){var c="https://app.embed.ly/organization/";c+="media"===a?[b.org&&b.org.slug?b.org.slug:"key/"+b.key,"analytics",k.format(k.offset(-6)),k.format(k.offset(1)),encodeURIComponent(b.url)].join("/"):[b.org&&b.org.slug?b.org.slug:"test-embedly","cards",b.org&&b.org.domain?b.org.domain:f.getDomain(b.url),encodeURIComponent(b.url),k.format(k.offset(-6)),k.format(k.offset(1))].join("/"),d.each(e.all(".stats-detail"),function(a){a.innerHTML='<a href="'+c+'" target="_blank">View in Dashboard<span>&nbsp;&gt;</span></a>'})}}else"media"===k.group&&(d.each(e.all(".stats-detail"),function(a){a.innerHTML=['<div class="stats-detail-left">','<a id="hideOverlay" href="https://cdn.embedly.com/widgets/options.html" target="_blank">disable</a>',"</div>",'<div class="stats-detail-right">','<a id="whatsThis" href="http://embed.ly/analytics/stats" target="_blank">What\'s this?</a>',"</div>"].join("")}),k.track(e.one("#hideOverlay"),"disable-overlay"),k.track(e.one("#whatsThis"),"whats-this"))},this)):!1},k._get=function(a,b,c,d,e){k.hub.get("xcomm.stats."+k.group+"."+a,b,function(a){var b=new k.StatsData(a.results,c,d);e.call(null,b)})},k.get=function(a,b,c,e){if(d.isNone(b)||""===document.referrer)return!1;var f=k.offset(-6),g=k.offset(1);d.assert(c.filter,"Need to set a filter");var j={start:k.format(f),end:k.format(g)};j=d.extend(j,c);var l="cards"===a?i.cards():i.media();l.of(b,j,d.bind(function(b){h.console.log(a+".of",b),e(b)},this))},k.recommend=function(a,b){if(d.isNone("cards"!==a.group))return!1;var c={source:f.getDomain(a.referrer),embed:a.url,key:"internal"},e=i.cards();e.recommend(c,b)},k.configure=function(a,b){return d.assert(null!==k.instance),a=d.extend({},a?a:{}),k.options=a,k.options.parent=a.parent?a.parent:document.body,k.group=b?b:k.instance.group,k.instance},k.connect=function(a,b,c){return d.assert(null===k.instance),k.hub=a,k.instance=new k.StatsContainer(a),b&&k.configure(b,c),a.on("stats.info.show",function(){k.info(a)}),a.on("stats.open",function(b){k.hover=!1,k.instance.draw(),a.notify("track.event","stats","view","overlay"),a.notify("stats.open.response")}),a.on("stats.data.realtime",function(){var b=k.offset(0,-90),c=k.offset(0),d={url:k.options.url,filter:k.options.filter,realtime:!0,key:k.options.key};k._get("realtime",d,b,c,function(b){a.notify("stats.data.realtime.response",b)})}),a.on("stats.data.week",function(){var b=k.offset(-6),c=k.offset(1),d={url:k.options.url,filter:k.options.filter,start:k.format(b),end:k.format(c),key:k.options.key};k._get("week",d,b,c,function(b){a.notify("stats.data.week.response",b)})}),a.on("stats.data.overview",function(){var b=new g;a.get("stats.data.realtime",{},b.callback()),a.get("stats.data.week",{},b.callback()),b.wait(function(b){a.notify("stats.data.overview.response",b[0],b[1])})}),a.on("stats.close",function(){k.instance&&k.instance.clear()}),l.connect(a),m.connect(a),n.connect(a),o.connect(a),p.connect(a),k.instance},b.exports=k},{"../api.js":2,"../browser.js":3,"../dom.js":5,"../graphs.js":6,"../keeper.js":8,"../urlparse.js":21,"../utils.js":23,"./bar.js":11,"./data.js":13,"./heatmap.js":14,"./info.js":15,"./init.js":16,"./loading.js":17,"./overview.js":18,"./refresh.js":19,conf:"AqyHQT"}],13:[function(a,b,c){var d=a("./init.js"),e=a("../utils.js");d.StatsData=function(a,b,c){this.init(a,b,c)},d.StatsData.prototype.init=function(a,b,c){this.data=a,this.start=b,this.end=c,this.loads=0,this.views=0,this.hovers=0,this.clicks=0,this.plays=0,this.playtime=0,this.average_playtime=0,this.duration=0,this.totals={unique:{},actions:{},media:{playtime:0,heat:0}},e.each(this.data,function(a){if(e.every([a.media,a.actions,a.unique],e.isEmptyObject))return!0;var b;e.each(["unique","actions"],function(c){e.each(["load","view","hover","play","click"],function(d){b=e.get(a[c],d,0),this.totals[c].hasOwnProperty(d)?this.totals[c][d]+=b:this.totals[c][d]=b},this)},this),e.get(a.unique,"play")&&e.get(a.media,"average_playtime")&&(this.totals.media.playtime+=a.unique.play*a.media.average_playtime),e.get(a.media,"duration")&&(this.totals.media.duration=a.media.duration),e.get(a.media,"watched",[]).length>1&&(this.totals.media.heat+=1)},this),this.totals.unique.play&&this.totals.media.playtime&&(this.totals.media.average_playtime=Math.floor(this.totals.media.playtime/this.totals.unique.play))},d.StatsData.prototype.range=function(){var a=[this.start.getMonth()+1+"/"+this.start.getDate(),this.end.getMonth()+1+"/"+this.end.getDate()].join(" - ");return a}},{"../utils.js":23,"./init.js":16}],14:[function(a,b,c){var d=a("../utils.js"),e=a("../dom.js"),f=a("../graphs.js"),g=a("./init.js"),h={};h.html=['<div class="stats-actions clearfix">','<ul class="actions-tab actions-right inline-list">','<li><a href="#" class="stats-actions-interval" data-interval="hour">Week</a></li>','<li><a href="#" class="stats-actions-interval" data-interval="minute">Realtime</a></li>',"</ul>","</div>",'<div class="stats-graph"></div>','<div class="stats-totals clearfix">','<ul class="totals-media inline-list">','<li><b>Plays</b><span class="stats-totals-play"></span></li>','<li><b>Average Playtime</b><span class="stats-totals-average"></span></li>','<li><b>Duration</b><span class="stats-totals-duration"></span></li>','<li><b>Total Playtime</b><span class="stats-totals-playtime"></span></li>',"</ul>","</div>"].join(""),h.title=['<a href="#" class="stats-back">&lt; Back</a>','<h4>Attention Heatmap | <span class="stats-range"></span></h4>'].join(""),h.graph=function(a,b){var c=e.one(".stats-graph");c.innerHTML="";var h=new f.Graph(c,a.data,b),i=a.totals;e.set(".stats-totals-play",g.comma(d.get(i,"unique.play",0)));var j=e.one(".stats-totals-average").parentNode;"minute"===b.interval?e.addClass(j,"hide"):(e.removeClass(j,"hide"),e.set(".stats-totals-average",f.playtime(d.get(i,"media.average_playtime",0),2))),e.set(".stats-totals-duration",f.playtime(d.get(i,"media.duration",0),2)),e.set(".stats-totals-playtime",f.playtime(d.get(i,"media.playtime",0),2)),h.heat(),d.each(e.all(".stats-actions-interval"),function(a){b.interval===e.data(a,"interval")?e.addClass(a.parentNode,"active"):e.removeClass(a.parentNode,"active")}),e.set(".stats-range",a.range())},h.render=function(a,b){var c=e.one(".stats-block");c.innerHTML=h.html;var f=e.one(".stats-title");f.innerHTML=h.title,g.back(),b=d.extend({interval:"hour",height:100},b?b:{}),h.graph(a,b),g.hub.off("window.resize"),g.hub.on("window.resize",function(){h.graph(a,b)}),d.each(e.all(".stats-actions-interval"),function(a){e.addEvent(a,"click",function(a){a=e.event(a),a.stop(),g.hub.notify("refresh.stop");var c=e.data(a.target,"interval");g.track("change-interval",c),"minute"===c?g.hub.notify("stats.heatmap.realtime",b):g.hub.notify("stats.heatmap.week",b)})})},h.connect=function(a){a.on("stats.heatmap.render",h.render),a.on("stats.heatmap.realtime",function(b){a.get("stats.data.realtime",{},function(a){b=b?b:{},b.interval="minute",h.render(a,b)})}),a.on("stats.heatmap.week",function(b){a.get("stats.data.week",{},function(a){b=b?b:{},b.interval="hour",h.render(a,b)})})},b.exports=h},{"../dom.js":5,"../graphs.js":6,"../utils.js":23,"./init.js":16}],15:[function(a,b,c){var d=a("./init.js"),e=a("../dom.js"),f=a("../browser.js");d.info=function(a){if(!f.supports.svg()||!f.supports.postMessage())return!1;var b;e.addEvent(document.body,"mouseenter",function(){if(d.hover===!1)return!1;var c=e.one("#statsInfo");null!==c&&e.remove(c);var f=document.body.offsetWidth,g=document.body.offsetHeight;if(200>g||330>f)return!1;b=e.create("a",{id:"statsInfo"}),document.body.appendChild(b),b.appendChild(e.create("i")),setTimeout(function(){b&&e.addClass(b,"stats-animate")},750),e.addEvent(b,"click",function(){e.remove(b),b=null,a.notify("stats.info.click")})}),e.addEvent(document.body,"mouseleave",function(){b&&e.remove(b)})}},{"../browser.js":3,"../dom.js":5,"./init.js":16}],16:[function(a,b,c){var d=a("../utils.js"),e=a("../dom.js"),f={hover:!0,instance:null,hub:null,group:null};f.today=function(){var a=new Date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},f.offset=function(a,b){var c=f.today();return c.setDate(c.getDate()+a),d.isNone(b)||c.setMinutes(c.getMinutes()+b),c},f.format=function(a){return d.map([a.getFullYear(),a.getMonth()+1,a.getDate()],function(a){return 10>a?"0"+a.toString():a.toString()}).join("")},f.comma=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},f.truncate=function(a,b){if(d.isNone(a))return a;if(b=b?b:100,a=a.replace(/https?:\/\//,""),"www."===a.substr(0,4)&&(a=a.substr(4)),a.length<b)return a;var c=a.split("?");2===c.length&&(a=c[0]);for(var e,f=a.split("/"),g="",h=0;h<f.length;h++)if(e=f[h],0!==h){if(g.length+e.length+3>b){g+="/...";break}g+="/"+e}else g+=e;return g},f.track=function(a,b){f.hub&&(d.isElement(a)?f.hub.notify("track.click",a,"stats",b):f.hub.notify("track.event","stats",a,b))},f.percent=function(a){return(100*a).toFixed(2)+"%"},f.back=function(){e.addEvent(e.one(".stats-back"),"click",function(a){var b=e.event(a);b.stop(),f.hub.notify("stats.refresh.clear"),f.hub.notify("stats.overview")})},b.exports=f},{"../dom.js":5,"../utils.js":23}],17:[function(a,b,c){var d=a("../utils.js"),e=a("../dom.js"),f={};f.start=function(){var a=e.create("div",{"class":"stats-loading"}),b=e.one(".stats-block");b.innerHTML="",b.appendChild(a);for(var c=b.offsetWidth,f=50,g=e.svg("svg",{id:"loading",width:c,height:f}),h=10/3,i=c/h,j=[],k=0;i>k;k++)j.push(Math.floor(Math.random()*f));var l,m,n=function(a,b){var c=Math.random()>.5?1:-1;setInterval(function(){b+=c,0>=b?(c=1,b=0):b>f&&(c=-1),a.setAttribute("height",b),a.setAttribute("y",f-b)},20)};d.each(j,function(a,b){m=b*(h+1),l=e.svg("rect",{width:h,height:a,x:m,y:f-a}),g.appendChild(l),n(l,a)}),a.appendChild(g)},f.connect=function(a){a.on("stats.loading.start",function(){f.start()}),a.on("stats.loading.stop",function(){})},b.exports=f},{"../dom.js":5,"../utils.js":23}],18:[function(a,b,c){var d=(a("../utils.js"),a("../dom.js")),e=a("../graphs.js"),f=a("./init.js"),g={};g.engagement=['<div class="stats-divider">',"<hr>","<span>Realtime Engagement</span>","</div>",'<div class="stats-pane">','<div class="ui-block-1">','<h1 class="overview-engagement"></h1>',"<h2>Engagement</h2>",'<span class="overview-total-impressions"></span>',"</div>",'<div class="ui-block-2">','<div class="overview-impressions"></div>','<a class="overview-expand expand-bar" href="#">expand</a>',"</div>","</div>"].join(""),g.heatmap=['<div class="stats-divider">',"<hr>","<span>Attention Heatmap</span>","</div>",'<div class="stats-pane">','<div class="ui-block-1">','<h1 class="overview-attention"></h1>',"<h2>Attention Minutes</h2>","</div>",'<div class="ui-block-2">','<div class="overview-heatmap"></div>','<a class="overview-expand expand-heatmap" href="#">expand</a>',"</div>","</div>"].join(""),g.title=['<a href="http://embed.ly" class="stats-e" target="_blank"></a>','<h4>Analytics | <span class="stats-range"></span></h4>'].join(""),g.getData=function(a,b){var c;if(b.totals.unique.load&&a.totals.unique.load)c=b.totals.unique.load>a.totals.unique.load?b.totals.unique:a.totals.unique;else if(b.totals.unique.load)c=b.totals.unique;else{if(!a.totals.unique.load)return{load:0,hover:0,play:0};c=a.totals.unique}return{load:c.load?c.load:0,hover:c.hover?c.hover:0,play:c.play?c.play:0}},g.getEngagement=function(a,b){var c,d=g.getData(a,b);return c=d.load?d.play?d.play/d.load:d.hover/d.load:0,(100*c).toFixed(1)+"%"},g.graph=function(a,b){var c=d.one(".overview-impressions"),f=d.one(".overview-heatmap");if(c){c.innerHTML="";var g=b.totals.unique.play?["load","play"]:["load","hover"],h=new e.Graph(c,a.data,{interval:"minute",height:50,marginBottom:0,marginLeft:0,label:!1});h.bar(g)}if(f){f.innerHTML="";var i=new e.Graph(f,b.data,{interval:"hour",height:50,marginBottom:0,label:!1});i.heat()}},g.render=function(a,b){var c=d.one(".stats-title");c.innerHTML=g.title;var e=d.one(".stats-block"),h=b.totals,i=g.getData(a,b),j=g.engagement;h.media.heat&&(j+=g.heatmap),e.innerHTML=j;var k=g.getEngagement(a,b);d.text(d.one(".overview-engagement"),k),i.load&&d.text(d.one(".overview-total-impressions"),f.comma(i.load)+" impressions"),d.set(".stats-range",b.range()),g.graph(a,b);var l=d.one(".overview-heatmap"),m=d.one(".overview-impressions");d.addEvent(m,"click",function(){f.track("click","overview-bar"),f.hub.notify("stats.bar.render",a,{interval:"minute"})}),d.addEvent(l,"click",function(){f.track("click","overview-heatmap"),f.hub.notify("stats.heatmap.render",b)});var n=d.one(".overview-attention");d.text(n,f.comma(Math.round(h.media.playtime/60))),d.addEvent(d.one(".expand-bar"),"click",function(){f.track("click","expand-bar"),f.hub.notify("stats.bar.render",a,{interval:"minute"})}),d.addEvent(d.one(".expand-heatmap"),"click",function(){f.track("click","expand-heatmap"),f.hub.notify("stats.heatmap.render",b)}),f.hub.off("window.resize"),f.hub.on("window.resize",function(){g.graph(a,b)}),f.hub.notify("stats.overview.response",b)},g.connect=function(a){a.on("stats.overview.render",g.render),a.on("stats.overview",function(){a.get("stats.data.overview",{},function(a,b){g.render(a,b)})})},b.exports=g},{"../dom.js":5,"../graphs.js":6,"../utils.js":23,"./init.js":16}],19:[function(a,b,c){var d=(a("../utils.js"),a("../dom.js")),e=a("./init.js"),f={noCountdown:!1,countdownHover:!1,countdown:null,count:0};f.start=function(a){if(f.noCountdown===!0)return!1;var b,c=d.one(".actions-refresh"),g=!1;if(0===d.all(".stats-actions-refresh").length){var h=d.create("a",{href:"#","class":"stats-actions-refresh"},"Refresh");b=d.create("a",{href:"#","class":"stats-countdown"}),c.appendChild(h),c.appendChild(b),d.addEvent(b,"click",function(a){a=d.event(a),a.stop(),f.noCountdown=!0,clearInterval(f.countdown),d.text(b," "),e.track("cancel","countdown")}),d.addEvent(b,"mouseenter",function(a){g=!0,d.text(b,"(âˆ’)"),d.addClass(b,"remove")}),d.addEvent(b,"mouseleave",function(a){g=!1,d.removeClass(b,"remove"),f.noCountdown||d.text(b,"("+i+")")}),d.addEvent(h,"click",function(b){b=d.event(b),b.stop(),e.track("click","refresh"),clearInterval(f.countdown),a.notify("stats.refresh")}),d.removeClass(c,"hide")}else b=d.one(".stats-countdown");var i=30;f.count>5?(f.noCountdown=!0,d.text(b," ")):f.countdown=setInterval(function(){return i+=-1,0===i?(clearInterval(f.countdown),f.count+=1,d.text(b,"(0)"),a.notify("stats.refresh"),!0):void(g===!1&&d.text(b,"("+i+")"))},1e3)},f.connect=function(a){a.on("stats.refresh.clear",function(){a.off("stats.refresh");var b=d.one(".actions-refresh");b&&(b.innerHTML=""),f.count=0,clearInterval(f.countdown),f.countdown=null}),a.on("stats.refresh.start",function(){f.start(a)})},b.exports=f},{"../dom.js":5,"../utils.js":23,"./init.js":16}],20:[function(a,b,c){var d=a("./utils.js"),e=a("./dom.js"),f=a("./urlparse.js"),g=a("./browser.js"),h=a("./api.js"),i={instance:null};i.COOKIE_NAME="em_cdn_uid",i.Track=function(){this.init()},i.Track.prototype.init=function(){this.data={},this.group=null,this.ignore=!1,this.uid=this.getUID(),this.sid=d.getUUID(),this.canTrack=!0,g.supports.cors()||(this.canTrack=!1),this._api=h.api()},i.Track.prototype.getUID=function(){var a=g.cookie.get(i.COOKIE_NAME);if(d.isNone(a))return this.setUID();var b=f.parseQuery(decodeURIComponent(a));if(!b.u||!b.t)return this.setUID();var c;try{c=parseInt(b.t,10)}catch(e){return this.setUID()}return 32!==b.u.length?this.setUID():d.getTimestamp()-c>15552e6?this.setUID(b.u):b.u},i.Track.prototype.setUID=function(a){var b={u:d.isNone(a)?d.getUUID():a,t:d.getTimestamp()},c=encodeURIComponent(f.createQuery(b));return g.cookie.set(i.COOKIE_NAME,c,365),c=g.cookie.get(i.COOKIE_NAME),d.isNone(c)?0:(b=f.parseQuery(decodeURIComponent(c)),b.u)},i.Track.prototype.ga=function(a){if(g.console.log("Track.ga",a),!window.ga)return!1;var b=["click","play","pause","finish","shown"];if("button"===this.group&&"view"===a.a||"stats"===a.c);else if(!d.contains(b,a.a))return!1;var c=a.l;d.isNone(a.l)&&this.data.schema&&(c=this.data.schema),window.ga("send","event",a.c,a.a,c,{dimension1:a.r,dimension2:a.u})},i.Track.prototype.api=function(a){if(this.ignore===!0)return!1;var b=["view","play","finish","progress","click","hover","load","meta"];return d.contains(b,a.a)?"stats"===a.c?!1:(g.console.log("Track.api",a),void this._api.event(a,function(a){g.console.log("Track.api.logged",a)})):!1},i.Track.prototype.event=function(a,b,c,e){var f={uid:this.uid,sid:this.sid,u:this.data.url,r:this.referrer,g:this.group,t:d.getTimestamp(),c:a,a:b,l:c,key:this.data.key,s:this.data.schema};d.isNone(e)||(f=d.extend(f,e));var g={};d.each(f,function(a,b){d.isNone(a)||""===a||(g[b]=a)}),this.canTrack&&this.api(g),this.ga(g)},i.Track.prototype.click=function(a,b,c){e.addEvent(a,"click",d.bind(function(){this.event(b,"click",c)},this))},i.Track.prototype.hover=function(a,b){if(!d.isNone(a)){var c={elem:a,category:b,track:this,done:!1};e.addEvent(a,"mouseover",d.bind(function(){this.done===!1&&(this.done=!0,this.track.event(this.category,"hover"))},c))}},i.configure=function(a,b,c){return d.assert(null!==i.instance),i.instance.data=a,i.instance.group=b,i.instance.ignore=d.isNone(c)?!1:c,i.instance.referrer=a.referrer?a.referrer:document.referrer,d.isNone(i.instance.data.url)&&(i.instance.canTrack=!1),i.instance},i.connect=function(a){return d.assert(null===i.instance),i.instance=new i.Track,a.on("track.event",function(a,b,c,d){i.instance.event(a,b,c,d)}),a.on("track.click",function(a,b,c){i.instance.click(a,b,c)}),a.on("track.hover",function(a,b){i.instance.hover(a,b)}),i.instance},b.exports=i},{"./api.js":2,"./browser.js":3,"./dom.js":5,"./urlparse.js":21,"./utils.js":23}],21:[function(a,b,c){var d=a("./utils.js"),e={};e.createQuery=function(a){var b=[],c="";return a&&d.isObject(a)&&!d.isEmptyObject(a)?(d.each(a,function(a,c){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}),b.sort(),b.join("&")):c},e.parseQuery=function(a){var b={};if(!a||!d.isString(a))return b;("#"===a.substr(0,1)||"?"===a.substr(0,1))&&(a=a.substr(1));var c=a.split("&");return d.each(c,function(a){if(!a)return!0;var c=a.split("="),d=decodeURIComponent(c[0]);1===c.length?b[d]="":2===c.length?b[d]=decodeURIComponent(c[1]):b[d]=decodeURIComponent(c.slice(1).join("="))}),b},e.getQuery=function(a){if(!a||!d.isString(a))return{};var b=a.split("?");return 2===b.length?e.parseQuery(b[1]):b.length>2?e.parseQuery(b.slice(1).join("?")):{}},e.appendQuery=function(a,b){if(!a||!d.isString(a))return null;var c=a.split("?"),f=c[0];if(!b||!d.isObject(b)||d.isEmptyObject(b))return a;var g=e.getQuery(a);return g=d.extend(g,b),d.isEmptyObject(g)?a:[f,e.createQuery(g)].join("?")},e.removeQuery=function(a,b){if(!a||!d.isString(a))return null;var c=a.split("?"),f=c[0],g=e.getQuery(a);return g.hasOwnProperty(b)&&delete g[b],d.isEmptyObject(g)?f:[f,e.createQuery(g)].join("?")},e.getOrigin=function(a){if(!a||!d.isString(a))return null;if(!/^https?:\/\//.test(a))return null;var b=a.split("/").slice(0,3).join("/");return-1===b.indexOf(".")?null:b},e.getDomain=function(a){var b=e.getOrigin(a);return b?b.replace(/^https?:\/\//,""):null},e.Parsed=function(a,b){this.init(a,b)},e.Parsed.prototype.init=function(a,b){this.original=a,this.url=b,this._valid=!1,this.url=b},e.Parsed.prototype.valid=function(a){return(a===!0||a===!1)&&(this._valid=a),this._valid},e.parse=function(a){var b=a,c="https:"===window.location.protocol?"https:":"http:";a=a?d.trim(a):a;var f=new e.Parsed(b,a);return a?/^https?:\/\/[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f):/^\w+:/i.test(a)?f:"#"===a[0]?f:/^\/\/[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f.url=c+a,f):/^\/([^\/]+|$)/i.test(a)?(f.valid(!0),f.url=e.getOrigin(window.location.toString())+a,f):/^[^\/]+\.[^\/]/i.test(a)?(f.valid(!0),f.url="http://"+a,f):f:f},e.addHash=function(a,b){return-1===a.indexOf("#")?a+"#"+b:a+"&"+b},b.exports=e},{"./utils.js":23}],22:[function(a,b,c){var d=a("./utils.js"),e=a("./urlparse.js"),f=a("./browser.js"),g=a("conf"),h={};h.get=function(){var a=f.cookie.get("embly_u");if(d.isNone(a))return null;if(!window.atob)return null;var b;try{b=JSON.parse(window.atob(a))}catch(c){return f.console.log(c),null}return new h.User(b)},h.save=function(a){var b=new h.User(a);return b.save()},h.remove=function(a){f.cookie.del("embly_u")},h.User=function(a){this.init(a)},h.User.prototype.init=function(a){this.orgs=a.orgs,this.s=a.s},h.User.prototype.data=function(){return{s:this.s?!0:!1,orgs:this.orgs}},h.User.prototype.orgByKey=function(a){if(this.orgs&&d.isArray(this.orgs))for(var b,c=0;c<this.orgs.length;c++)if(b=this.orgs[c],a===b.key||a===b.iframe_key)return b;return null},h.User.prototype.orgByUrls=function(a,b){var c=e.getDomain(b),f=e.getDomain(a);if(this.orgs&&d.isArray(this.orgs))for(var g,h,i=0;i<this.orgs.length;i++)if(g=this.orgs[i],g.cards&&d.isArray(g.cards))for(var j=0;j<g.cards.length;j++)if(h=g.cards[j],h===c||h===f)return g.domain=h,
g;return null},h.User.prototype.save=function(){var a={};if(d.each(["orgs","s"],function(b){this.hasOwnProperty(b)&&this[b]&&(a[b]=this[b])},this),!window.atob)return!1;var b;try{b=window.btoa(JSON.stringify(a))}catch(c){return f.console.log(c),!1}return f.cookie.set("embly_u",b,365,g.EMB_DEBUG===!1),!0},h.User.prototype.remove=function(){f.cookie.del("embly_u")},b.exports=h},{"./browser.js":3,"./urlparse.js":21,"./utils.js":23,conf:"AqyHQT"}],23:[function(a,b,c){var d=a("conf"),e={},f={},g=Array.prototype,h=Object.prototype,i=Function.prototype,j=(g.push,g.slice),k=(g.concat,h.toString),l=g.forEach,m=(g.map,g.reduce),n=(g.reduceRight,g.filter,g.every),o=(g.some,g.indexOf),p=(g.lastIndexOf,Array.isArray,Object.keys,i.bind);e.identity=function(a){return a},e.each=function(a,b,c){if(null!=a)if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(d in a&&b.call(c,a[d],d,a)===f)return}else for(var g in a)if(h.hasOwnProperty.call(a,g)&&b.call(c,a[g],g,a)===f)return},e.map=function(a,b,c){var d=[];return null==a?d:Array.prototype.map&&a.map===Array.prototype.map?a.map(b,c):(e.each(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},e.reduce=function(a,b,c,d){var f=arguments.length>2;if(null==a&&(a=[]),m&&a.reduce===m)return d&&(b=e.bind(b,d)),f?a.reduce(b,c):a.reduce(b);if(e.each(a,function(a,e,g){f?c=b.call(d,c,a,e,g):(c=a,f=!0)}),!f)throw new TypeError("Reduce of empty array with no initial value");return c},e.zip=function(a){return e.map(a[0],function(b,c){return b.map(a,function(a){return a[c]})})},e.extend=function(a){return e.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},e.contains=function(a,b){if(!o){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}return a.indexOf(b)>-1},e.every=function(a,b,c){b||(b=e.identity);var d=!0;return null==a?d:n&&a.every===n?a.every(b,c):(e.each(a,function(a,e,g){return(d=d&&b.call(c,a,e,g))?void 0:f}),!!d)},e.indexOf=function(a,b){if(null==a)return-1;var c=0,d=a.length;if(o&&a.indexOf===o)return a.indexOf(b);for(;d>c;c++)if(a[c]===b)return c;return-1};var q=function(){};e.bind=function(a,b){var c,d;if(p&&a.bind===p)return p.apply(a,j.call(arguments,1));if(!e.isFunction(a))throw new TypeError;return c=j.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(j.call(arguments)));q.prototype=a.prototype;var e=new q;q.prototype=null;var f=a.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}},e.get=function(a,b,c){if(c=e.isNone(c)?null:c,e.isNone(b)||!e.isString(b)||!a)return c;if(""===b)return a;var d=b.split("."),f=d.splice(0,1)[0];return a.hasOwnProperty(f)?e.get(a[f],d.join("."),c):c},e.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return!1}},e.isNone=function(a){return null===a||void 0===a},e.isString=function(a){return"[object String]"===k.call(a)},e.isNumber=function(a){return"[object Number]"===k.call(a)},e.isDate=function(a){return"[object Date]"===k.call(a)},e.isObject=function(a){return"[object Object]"===k.call(a)},e.isArray=function(a){return"[object Array]"===k.call(a)},e.isElement=function(a){return!e.isNone(a)&&!e.isNone(a.nodeType)&&1===a.nodeType},e.isEmptyObject=function(a){if(e.isObject(a)){for(var b in a)if(h.hasOwnProperty.call(a,b))return!1;return!0}return!1},e.bool=function(a){return e.isNone(a)?null:"true"===a||"1"===a||1===a||a===!0?!0:"false"===a||"0"===a||0===a||a===!1?!1:null},e.assert=function(a,b){if(!a)throw b||"Assertion Failed"},e.getUUID=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},e.getTimestamp=function(){var a=new Date;return a.getTime()},e.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},e.capitalize=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},e.camelCase=function(a){var b=a.split("-");return b.length>1&&(a=b[0],a+=e.map(b.slice(1),function(a){return a[0].toUpperCase()+a.substr(1)}).join("")),a},e.truncate=function(a,b){return a?(b=b?b:50,a.length<b?a:(a=a.substr(0,b-3),e.trim(a)+"...")):""},e.hash=function(a){for(var b=0,c=0,d=a.length;d>c;c++)b=31*b+a.charCodeAt(c)<<0;return(Math.pow(2,31)+b).toString()},e.rgbToHex=function(a,b,c){return"#"+((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},d.EMB_DEBUG===!0&&(window._=e),b.exports=e},{conf:"AqyHQT"}],conf:[function(a,b,c){b.exports=a("AqyHQT")},{}],AqyHQT:[function(a,b,c){!function(a){a.EMB_DEBUG=!1,a.EMB_HTTPS="https:"===window.location.protocol?!0:!1,a.EMB_ORIGIN=(a.EMB_HTTPS?"https":"http")+"://cdn.embedly.com",a.EMB_FRAME_SRC=a.EMB_ORIGIN+"/widgets/",a.EMB_SECURE_FRAME_SRC="https://cdn.embedly.com/widgets/",a.EMB_POST_MESSAGE=!!window.postMessage,a.EMB_PROGRESS=!0,a.EMB_APP_API="https://app.embed.ly",a.EMB_API_KEY="fd92ebbc52fc43fb98f69e50e7893c13";var b=window.location.pathname.split(".")[0].split("/");a.EMB_GROUP=b[b.length-1].toLowerCase(),a.PAGE_PROGRESS_DOMAINS=[]}("undefined"==typeof b?this.conf={}:b.exports)},{}],26:[function(a,b,c){var d=a("./common/receiver.js"),e=a("./common/browser.js"),f=a("./common/stats/base.js"),g=a("./common/users.js"),h=a("./common/utils.js"),i=a("./common/a.js"),j=a("./common/track.js"),k=a("./common/progress.js"),l=new i;l.on("xcomm.stats.access",function(a){var b,c=g.get(),d={access:!1,org:null,disabled:!1};null!==c&&("media"===a.group?b=c.orgByKey(a.key):"card"===a.group&&(b=c.orgByUrls(a.url,a.ref)),b&&(d.access=!0,d.org=b),null===b&&c.s&&(d.access=!0,d.s=!0)),d.disabled="1"===e.cookie.get("embly_d"),d=h.extend(a,d),l.notify("receiver.send","xcomm.stats.access",d)});var m=function(a){l.on(a,function(b){f.get("cards",b.url,{filter:b.filter,key:"internal",start:b.start,end:b.end,realtime:h.isNone(b.realtime)?!1:!0},function(b){l.notify("receiver.send",a,{results:b})})})};m("xcomm.stats.card"),m("xcomm.stats.card.realtime"),m("xcomm.stats.card.week");var n=function(a){l.on(a,function(b){f.get("media",b.url,{filter:b.filter,key:b.key,start:b.start,end:b.end,realtime:h.isNone(b.realtime)?!1:!0},function(b){l.notify("receiver.send",a,{results:b})})})};n("xcomm.stats.media"),n("xcomm.stats.media.realtime"),n("xcomm.stats.media.week"),l.on("xcomm.user.get",function(){var a=g.get(),b={s:!1,orgs:[]};a&&(b=a.data()),l.notify("receiver.send","xcomm.user.get",{user:b})}),l.on("xcomm.user.set",function(a){g.save({s:a.s,orgs:a.orgs});var b=g.get();l.notify("receiver.send","xcomm.user.set",{user:b.data()})}),l.on("xcomm.user.remove",function(a){g.remove();var b=g.get();l.notify("receiver.send","xcomm.user.remove",{user:b})}),l.on("xcomm.stats.media.recommend",function(a){f.recommend(a,function(a){l.notify("receiver.send","xcomm.stats.media.recommend",{results:a})})}),l.on("xcomm.stats.card.recommend",function(a){f.recommend(a,function(a){l.notify("receiver.send","xcomm.stats.card.recommend",{results:a})})}),l.on("xcomm.page.progress",function(a){k.page(l);l.on("page.progress.data",function(a){l.notify("track.event","page","progress",k.stringify(a.times))}),l.notify("receiver.send","xcomm.page.progress")}),d.connect(l),j.connect(l),j.configure({url:document.referrer},"page"),l.notify("receiver.send","xcomm.ready")},{"./common/a.js":1,"./common/browser.js":3,"./common/progress.js":9,"./common/receiver.js":10,"./common/stats/base.js":12,"./common/track.js":20,"./common/users.js":22,"./common/utils.js":23}]},{},[26]);</script>
</body></html>