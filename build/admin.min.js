/*! Soundninja 2015-07-24 */

this.SN=this.SN||{},this.SN.admin=this.SN.admin||{},this.SN.admin.option=Handlebars.template({1:function(a){var b=this.lambda,c=this.escapeExpression;return'    <option value="'+c(b(null!=a?a.artist:a,a))+'">'+c(b(null!=a?a.text:a,a))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return null!=(e=b.each.call(a,a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:""},useData:!0}),this.SN.admin.panel=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a){return'<link rel="stylesheet" type="text/css" href="'+this.escapeExpression(this.lambda(null!=a?a.root:a,a))+'admin.css">\n<div class="sn-admin-panel">\n    <div class="adminContents">\n        <div class="sn-admin-panel-close SN-clickable">\n            <svg class="icon" viewBox="0 0 100 100">\n                <use xlink:href="#icon-cross" />\n            </svg>\n        </div>\n        <h2 class="sn-admin-panel-title">Soundninja</h2>\n\n        <h4 class="sn-admin-panel-title">Admin Panel</h4>\n\n        <p class="useWhitelist">\n            To add an artist whitelist, highlight their name with your mouse then select them from the list below\n        </p>\n\n        <p class="whitelistHelper">\n            Note: Be careful to highlight <strong>only</strong> the artist name and <strong>no</strong> punctuation (\', ", \'s or .)\n        </p>\n\n        <select class="sn-admin-panel-whitelist-candidates selectBox" multiple></select>\n\n        <div class="buttonHolder">\n            <a class="sn-admin-panel-whitelist-candidates-add SN-clickable sn-clickable-disabled SN-spotify-button">Add to whitelist</a>\n        </div>\n\n        <div>\n            <h4 class="sn-admin-panel-title">Whitelisted Artists:</h4>\n            <label>\n                <select class="sn-admin-panel-whitelist selectBox" multiple disabled></select>\n            </label>\n        </div>\n        <div class="sn-admin-panel-reload SN-clickable sn-clickable-disabled"></div>\n        <div class="buttonHolder">\n            <a class="sn-admin-panel-reload SN-clickable SN-spotify-button">Reload page</a>\n        </div>\n    </div>\n</div>'},useData:!0}),this.SN.admin.whitelisttip=Handlebars.template({1:function(a,b,c,d,e,f){var g=this.lambda,h=this.escapeExpression;return'    <option value="'+h(g(null!=a?a.id:a,a))+'" data-text="'+h(g(null!=f[1]?f[1].text:f[1],a))+'">'+h(g(null!=a?a.name:a,a))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d,e,f){var g;return null!=(g=b.each.call(a,null!=a?a.artists:a,{name:"each",hash:{},fn:this.program(1,d,0,e,f),inverse:this.noop,data:d}))?g:""},useData:!0,useDepths:!0}),function(a){function b(){function b(){var b=a(".sn-admin-panel");i.isOpen()?b.hide():b.show()}function c(){window.history.back()}function d(){window.location.reload()}function e(b){var c=a(".sn-admin-panel-"+b+"-candidates");a(".sn-admin-panel-"+b+"-candidates-add").on("click",function(){var d=c.prop("options")[c.prop("selectedIndex")];a.ajax("http://soundninja-django-py.herokuapp.com/artists/",{data:{echonest_id:d.value},method:"POST",type:"POST"}).done(function(){g(b,d)}).fail(function(a){a.responseJSON||(a.responseJSON=JSON.parse(a.responseText)),"This field must be unique."===a.responseJSON.echonest_id[0]&&g(b,d)})}),a.ajax("http://soundninja-django-py.herokuapp.com/whitelistitems/",{data:{page:f()}}).done(function(c){a(".sn-admin-panel-"+b).append(SN.admin.option(c))})}function f(){return window.location.origin+window.location.pathname}function g(b,c){var d=f();a(".sn-admin-panel-"+b).prepend(c),a.ajax("http://soundninja-django-py.herokuapp.com/pages/",{data:{url_pattern:d},method:"POST",type:"POST"}).done(function(){h(d,c)}).fail(function(a){a.responseJSON||(a.responseJSON=JSON.parse(a.responseText)),"This field must be unique."===a.responseJSON.url_pattern[0]&&h(d,c)})}function h(b,c){var e=a(c).data("text");a.ajax("http://soundninja-django-py.herokuapp.com/whitelistitems/",{data:{page:b,artist:c.value,text:e},method:"POST",type:"POST"}).done(function(){a(".sn-admin-panel-reload").off("click.reload").on("click.reload",d).removeClass("sn-clickable-disabled")})}var i=this;a(document.body).append(SN.admin.panel({root:chrome.extension.getURL("")})),a(window).on("hashchange",b),a(".sn-admin-panel-close").on("click",c),e("whitelist"),i.isOpen=function(){var b=a(".sn-admin-panel");return"none"!=b.css("display")},i.addOptions=function(b,c,d){var e=a(".sn-admin-panel-"+b+"-candidates");e.html(SN.admin[b+"tip"]({text:c,artists:d})).prop("selectedIndex",0),a(".sn-admin-panel-"+b+"-candidates-add").removeClass("sn-clickable-disabled")}}function c(b){function c(b){a.ajax("//soundninja-node-js.herokuapp.com/suggest",{data:{format:"json",name:b,results:100},dataType:"json"}).done(function(a){b==f&&d(b,a.response.artists)})}function d(a,c){b.addOptions("whitelist",a,c)}function e(){var e;b.isOpen()&&(e=getSelection().toString(),e&&e!=f&&(f=e,a.ajax("//soundninja-node-js.herokuapp.com/search",{data:{format:"json",name:e,results:100,bucket:["id:spotify","id:songkick","genre"],fuzzy_match:!0,sort:"familiarity-desc"},dataType:"json",traditional:!0}).done(function(a){if(e==f){var b;b=a.response.artists,b.length?d(e,b):c(e)}})))}var f;document.body.addEventListener("mouseup",e)}function d(){}var e=new b;new c(e),new d(e)}(jQuery);
//# sourceMappingURL=admin.min.js.map