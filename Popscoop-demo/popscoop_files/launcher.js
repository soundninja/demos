!function(t,e,o){"use strict";function i(t){return("https:"===o.location.protocol?"https":"http")+"://"+t.replace(/^((https?):)?\/\//,"")}function n(){var t=999;return-1!==navigator.appVersion.indexOf("MSIE")&&(t=parseFloat(navigator.appVersion.split("MSIE")[1])),t}function s(){function e(t){t.forEach(function(t){t=t.split("="),""!==t[0]&&(o[t[0]]=decodeURIComponent(t[1]||""))})}var o={},i=t.location.search.slice(1).split("&");e(i);var n=t.location.hash;return i=n.substring(n.indexOf("?")).slice(1).split("&"),e(i),JSON.parse(JSON.stringify(o))}function a(t,e,o){var i;try{i=new XMLHttpRequest("MSXML2.XMLHTTP.3.0"),i.open(e?"POST":"GET",t,1),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.onreadystatechange=function(){i.readyState>3&&o&&o(i.responseText,i)},i.send(e)}catch(n){}}function p(){if(e.spotId){var t=e.spotId.trim(),i=JSON.stringify([{name:"embed_spot_launcher_"+t,columns:["url","spot_id"],points:[[o.location.href,t]]}]),n=!1,s="goldiewilson-wedontneedroads-1.c.influxdb.com",p="8087",r="spotim_poc_production",d="spotim_poc_production_user",l="iedsfk3jkls23fdf8uefjwio123[hiuw",m="https://"+s+":"+p+"/db/"+r+"/series?u="+d+"&p="+l;n&&a(m,i)}}function r(t){var e=o.createElement("link");e.addEventListener("load",function(){t&&"function"==typeof t&&t()}),e.href=i(g+"/styles/initiator.css?ver="+S),e.rel="stylesheet",e.type="text/css",o.getElementsByTagName("head")[0].appendChild(e)}function d(t,e){var i=t+"{ ";for(var n in e)i+=n+": "+e[n]+";";i+="}";var s=o.getElementsByTagName("head")[0],a=o.createElement("style");return a.setAttribute("type","text/css"),a.styleSheet?a.styleSheet.cssText=i:a.appendChild(o.createTextNode(i)),s.appendChild(a),a}function l(t,e){var i;o.createEvent?(i=o.createEvent("HTMLEvents"),i.initEvent(e,!0,!0)):(i=o.createEventObject(),i.eventType=e),i.eventName=e,o.createEvent?t.dispatchEvent(i):t.fireEvent("on"+i.eventType,i)}function m(){e.posX&&!E&&(d("#spot-im-root.spot-im-floating.spot-im-right",{right:e.posX+" !important"}),d("#spot-im-root.spot-im-floating.spot-im-modal iframe",{right:e.posX+" !important",left:"initial !important"}),d("#spot-im-root.spot-im-floating.spot-im-left",{left:e.posX+" !important"}),d("#spot-im-root.spot-im-floating.spot-im-modal iframe",{left:e.posX+" !important",right:"initial !important"})),e.posY&&!E&&(d("#spot-im-root.spot-im-floating.spot-im-bottom",{bottom:e.posY+" !important"}),d("#spot-im-root.spot-im-floating.spot-im-modal.spot-im-bottom iframe",{bottom:e.posY+" !important"})),!e.top||b||E||d("#spot-im-root.spot-im-floating.spot-im-spot-state",{top:e.top+" !important"}),b&&!E&&(e.width&&d("#spot-im-root.spot-im-static, #spot-im-root-placeholder",{width:e.width}),e.height&&d("#spot-im-root.spot-im-static, #spot-im-root-placeholder",{height:e.height}))}function c(t,e){var o=/{{(\w*)}}/gi;return t.replace(o,function(t,o){return e[o]||""})}function u(){if(e.startingRoute)return g+e.startingRoute;var t=null,o=h.sp_spotname,i=h.sp_spottype,n=h.sp_username,s=h.sp_spotid,a=h.sp_messageid;return t="public"===i&&o&&a?c(I.PUBLIC_SPOT_REPLY,{spotName:o,messageId:a}):"public"===i&&o?c(I.PUBLIC_SPOT_BY_NAME,{spotName:o}):"intimate"===i&&s?c(I.INTIMATE_SPOT_BY_ID,{spotId:s}):n?c(I.USER_PROFILE_BY_NAME,{spotName:e.spotName,username:n}):e.spotId?c(I.PUBLIC_SPOT_BY_ID,{spotId:e.spotId}):e.spotName?c(I.PUBLIC_SPOT_BY_NAME,{spotName:e.spotName}):I.UNDEFINED_ROUTE}function f(){r(function(){m(),M.initialize();var t=["type="+encodeURIComponent(e.type),"domain="+encodeURIComponent(o.domain),"version="+encodeURIComponent(S),"parentUrl="+encodeURIComponent(o.location.href)];e.spotId?t.push("spotId="+encodeURIComponent(e.spotId)):e.spotName&&t.push("spotName="+encodeURIComponent(e.spotName)),e.position&&(e.position=e.position.toLowerCase(),-1!==e.position.indexOf("left")?e.position="left":-1!==e.position.indexOf("right")&&(e.position="right"),t.push("position="+encodeURIComponent(e.position))),e.brandColor&&t.push("brandColor="+encodeURIComponent(e.brandColor)),e.iconUrl&&t.push("iconUrl="+encodeURIComponent(e.iconUrl)),e.spotRename&&t.push("spotRename="+encodeURIComponent(e.spotRename)),e.state&&t.push("state="+encodeURIComponent(e.state)),e.overrideState&&t.push("overrideState="+encodeURIComponent(e.overrideState)),b?(e.width&&t.push("width="+encodeURIComponent(e.width)),e.height&&t.push("height="+encodeURIComponent(e.height))):e.top&&t.push("top="+encodeURIComponent(e.top)),e.undocked&&t.push("undocked="+!0);var i=u();O.src="https:"+i+"?"+t.join("&")})}if(e||(e={}),e.mobileEmbedUrl||(e.mobileEmbedUrl="//v1.spot.im/membed"),e.embedUrl||(e.embedUrl="//v1.spot.im/embed"),!e.spotId&&!e.spotName)return void t.alert("Spot.IM Embed can't initialized without a spot.");if(n()<10)return void(t.console&&t.console.log&&t.console.log("Spot.IM doesn't support IE "+n()+" browser"));var h=s(),E=/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile/.test(t.navigator.userAgent),_="true"===h.forceMobile;if(!(e.allowDesktop===!1&&!E||e.allowMobile===!1&&E&&!_||E&&!_)){var S="4.1.412",g=null;g=E||_?e.mobileEmbedUrl:e.embedUrl,h.sp_state&&(e.overrideState=h.sp_state);var v={NOTICES_CLOSED_STATE:"notices-closed-state",NOTICES_OPENED_STATE:"notices-opened-state",SPOT_STATE:"spot-state",MODAL_STATE:"modal-state"};e.type=(e.type||"floating").toLowerCase();var T=(e.state||v.NOTICES_CLOSED_STATE).toLowerCase(),b="static"===e.type,I={PUBLIC_SPOT_BY_NAME:g+"/{{spotName}}",PUBLIC_SPOT_BY_ID:g+"/id/{{spotId}}",INTIMATE_SPOT_BY_ID:g+"/1on1/id/{{spotId}}",UNDEFINED_ROUTE:g+"/404",USER_PROFILE_BY_NAME:g+"/{{spotName}}/profile/{{username}}/about",PUBLIC_SPOT_REPLY:g+"/{{spotName}}/reply/{{messageId}}"},y=function(){function e(){f=0,o.title=o.title.replace(h,"","gi")}function i(){var t=o.title.match(h),e="("+f+") ";o.title=null!==t?o.title.replace(h,e,"gi"):e+o.title}function n(t){u=t,u?c():m()}function s(o){if(E!==o.type)switch(o.type){case"blur":n(!0);break;case"focus":t.setTimeout(function(){n(!1),e()},200)}E=o.type}function a(){t.addEventListener("blur",s),t.addEventListener("focus",s)}function p(){u?(f++,i()):e()}function r(t){u?(f=t,i()):e()}function d(){n(!1),e()}function l(){n(!0)}function m(){M.updateTabFocus()}function c(){M.updateTabBlur()}var u=o.hidden===!0||o.mozHidden===!0||o.webkitHidden===!0||o.msHidden===!0||o.onfocusin===!1,f=0,h=/^\(\d*\)/,E=null;return{start:a,increment:p,set:r,onEmbedFocus:d,onEmbedBlur:l}}(),C=o.getElementById(e.containerId),w=o.getElementsByTagName("body")[0];if(null===C&&(C=o.createElement("div"),C.id="spot-im-root"),C.parentNode&&"body"===C.parentNode.tagName.toLowerCase()||w.appendChild(C),b){var N=o.createElement("div");N.id="spot-im-root-placeholder",C.parentNode.insertBefore(N,C.nextSibling)}var O=o.createElement("iframe");C.appendChild(O);var U=["spot-im-"+e.type];C.className=U.join(" ");var R=O.contentWindow||O,M=function(t,e,o,i,n){return{initialize:function(){this.listenToMessages(),this.listenToWindowResize(),this.listenToUrl(),this.isReady=!1,y.start()},_notifyReady:function(){this.isReady=!0,l(e,"spot-im-ready"),o.className=U.join(" "),this.requestWindowSize()},_removeClass:function(t,e){var o=t.indexOf(e);-1!==o&&t.splice(o,1)},_addClass:function(t,e){var o=t.indexOf(e);-1===o&&t.push(e)},_postMessage:function(t,e){i.postMessage(JSON.stringify({action:t,params:e}),"*")},_updateState:function(t,i){this._removeEmbedSize();var n=this,s=this.state;if(n._removeClass(U,"spot-im-"+s),n._addClass(U,"spot-im-"+t),i.position&&(this.position&&n._removeClass(U,"spot-im-"+this.position),this.position=i.position,n._addClass(U,"spot-im-"+this.position)),b){var a=e.getElementsByTagName("body")[0];a.style.overflow=t===v.MODAL_STATE?"hidden":""}n.state=t,l(e,"spotim-state-changed"),n._postMessage("stateUpdated"),o.className=U.join(" "),this.isReady||this._notifyReady()},_removeEmbedSize:function(){this.embedSizeStyleRule&&(e.getElementsByTagName("head")[0].removeChild(this.embedSizeStyleRule),this.embedSizeStyleRule=null)},_getTitleElement:function(){return e.getElementsByTagName("title")[0]},state:n,position:null,maxEmbedSize:null,destroyEmbed:function(){o.contains(O)&&o.removeChild(O)},getWindowSize:function(){var o,i;return"BackCompat"===e.compatMode?(o=t.innerHeight,i=t.innerWidth):(o=e.documentElement.clientHeight,i=e.documentElement.clientWidth),{windowHeight:o,windowWidth:i}},listenToMessages:function(){var e=this;t.addEventListener("message",function(t){var o=null;try{o=JSON.parse(t.data)}catch(i){}if(o){var n=e[o.action];n&&"function"==typeof n&&n.call(e,o.params||{})}},!1)},listenToWindowResize:function(){var e=null,o=this;t.addEventListener("resize",function(){t.clearTimeout(e),e=t.setTimeout(function(){o.requestWindowSize()},300)},!1)},listenToUrl:function(){var e=this;t.addEventListener("popstate",function(){e.requestWindowUrl()})},noticesOpenedState:function(t){this._updateState(v.NOTICES_OPENED_STATE,t)},noticesClosedState:function(t){this._updateState(v.NOTICES_CLOSED_STATE,t)},spotState:function(t){this._updateState(v.SPOT_STATE,t)},modalState:function(t){this._updateState(v.MODAL_STATE,t)},requestWindowSize:function(){var t=this.getWindowSize();this._postMessage("windowSize",t)},requestBoundingRect:function(){var t=o.getBoundingClientRect();this._postMessage("boundingRect",{top:t.top,left:t.left,right:t.right,bottom:t.bottom})},requestWindowUrl:function(){this._postMessage("windowUrl",t.location.href)},applyEmbedSize:function(t){this._removeEmbedSize(),this.embedSizeStyleRule=d("#spot-im-root",{width:t.width+" !important","max-width":"initial !important"}),this._postMessage("embedSizeApplied")},websiteOpenEmbed:function(){this._postMessage("websiteOpenEmbed",!0)},startSSOProcess:function(){l(e,"spotim-sso")},setTabCounter:function(t){y.set(t)},notifyEmbedFocus:function(){y.onEmbedFocus()},notifyEmbedBlur:function(){y.onEmbedBlur()},updateTabFocus:function(){this._postMessage("updateTabFocus",!0)},updateTabBlur:function(){this._postMessage("updateTabBlur",!0)},loginSSOUser:function(t){this._postMessage("loginSSOUser",t)}}}(t,o,C,R,T,e.size);e.openEmbed=function(){M.websiteOpenEmbed()},e.loginSSOUser=function(t){M.loginSSOUser(t)},f(),p(),C.addEventListener("mousewheel",function(){},!1)}}(window,window.SPOTIM,document);